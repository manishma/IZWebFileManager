var qq,ExifRestorer,MbWaitSpinner;(function(n,t){typeof exports=="object"?module.exports=t():typeof define=="function"&&define.amd?define(t):n.Spinner=t()})(this,function(){"use strict";function i(n,t){var i=document.createElement(n||"div");for(var r in t)i[r]=t[r];return i}function t(n){for(var t=1,i=arguments.length;t<i;t++)n.appendChild(arguments[t]);return n}function a(n,t,i,r){var f=["opacity",t,~~(n*100),i,r].join("-"),o=.01+i/r*100,s=Math.max(1-(1-n)/t*(100-o),n),c=u.substring(0,u.indexOf("Animation")).toLowerCase(),l=c&&"-"+c+"-"||"";return h[f]||(e.insertRule("@"+l+"keyframes "+f+"{0%{opacity:"+s+"}"+o+"%{opacity:"+n+"}"+(o+.01)+"%{opacity:1}"+(o+t)%100+"%{opacity:"+n+"}100%{opacity:"+s+"}}",e.cssRules.length),h[f]=1),f}function o(n,t){var u=n.style,r,i;for(t=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<s.length;i++)if(r=s[i]+t,u[r]!==undefined)return r;if(u[t]!==undefined)return t}function n(n,t){for(var i in t)n.style[o(n,i)||i]=t[i];return n}function c(n){for(var r,i,t=1;t<arguments.length;t++){r=arguments[t];for(i in r)n[i]===undefined&&(n[i]=r[i])}return n}function l(n,t){return typeof n=="string"?n:n[t%n.length]}function r(n){this.opts=c(n||{},r.defaults,v)}function y(){function u(n,t){return i("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}e.addRule(".spin-vml","behavior:url(#default#VML)");r.prototype.lines=function(i,r){function s(){return n(u("group",{coordsize:o+" "+o,coordorigin:-e+" "+-e}),{width:o,height:o})}function a(i,f,o){t(c,t(n(s(),{rotation:360/r.lines*i+"deg",left:~~f}),t(n(u("roundrect",{arcsize:r.corners}),{width:e,height:r.width,left:r.radius,top:-r.width>>1,filter:o}),u("fill",{color:l(r.color,i),opacity:r.opacity}),u("stroke",{opacity:0}))))}var e=r.length+r.width,o=2*e,h=-(r.width+r.length)*2+"px",c=n(s(),{position:"absolute",top:h,left:h}),f;if(r.shadow)for(f=1;f<=r.lines;f++)a(f,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(f=1;f<=r.lines;f++)a(f);return t(i,c)};r.prototype.opacity=function(n,t,i,r){var u=n.firstChild;r=r.shadow&&r.lines||0;u&&t+r<u.childNodes.length&&(u=u.childNodes[t+r],u=u&&u.firstChild,u=u&&u.firstChild,u&&(u.opacity=i))}}var s=["webkit","Moz","ms","O"],h={},u,e=function(){var n=i("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),v={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:1/4,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"},f;return r.defaults={},c(r.prototype,{spin:function(t){this.stop();var f=this,r=f.opts,e=f.el=n(i(0,{className:r.className}),{position:r.position,width:0,zIndex:r.zIndex}),p=r.radius+r.length+r.width;if(n(e,{left:r.left,top:r.top}),t&&t.insertBefore(e,t.firstChild||null),e.setAttribute("role","progressbar"),f.lines(e,f.opts),!u){var s=0,l=(r.lines-1)*(1-r.direction)/2,h,c=r.fps,o=c/r.speed,a=(1-r.opacity)/(o*r.trail/100),v=o/r.lines;(function y(){s++;for(var n=0;n<r.lines;n++)h=Math.max(1-(s+(r.lines-n)*v)%o*a,r.opacity),f.opacity(e,n*r.direction+l,h,r);f.timeout=f.el&&setTimeout(y,~~(1e3/c))})()}return f},stop:function(){var n=this.el;return n&&(clearTimeout(this.timeout),n.parentNode&&n.parentNode.removeChild(n),this.el=undefined),this},lines:function(r,f){function s(t,r){return n(i(),{position:"absolute",width:f.length+f.width+"px",height:f.width+"px",background:t,boxShadow:r,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*e+f.rotate)+"deg) translate("+f.radius+"px,0)",borderRadius:(f.corners*f.width>>1)+"px"})}for(var e=0,h=(f.lines-1)*(1-f.direction)/2,o;e<f.lines;e++)o=n(i(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:u&&a(f.opacity,f.trail,h+e*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&t(o,n(s("#000","0 0 4px #000"),{top:"2px"})),t(r,t(o,s(l(f.color,e),"0 0 1px rgba(0,0,0,.1)")));return r},opacity:function(n,t,i){t<n.childNodes.length&&(n.childNodes[t].style.opacity=i)}}),f=n(i("group"),{behavior:"url(#default#VML)"}),!o(f,"transform")&&f.adj?y():u=o(f,"animation"),r}),function(n){if(typeof exports=="object")n(require("jquery"),require("spin"));else if(typeof define=="function"&&define.amd)define(["jquery","spin"],n);else{if(!window.Spinner)throw new Error("Spin.js not present");n(window.jQuery,window.Spinner)}}(function(n,t){n.fn.spin=function(i,r){return this.each(function(){var f=n(this),u=f.data();u.spinner&&(u.spinner.stop(),delete u.spinner);i!==!1&&(i=n.extend({color:r||f.css("color")},n.fn.spin.presets[i]||i),u.spinner=new t(i).spin(this))})};n.fn.spin.presets={tiny:{lines:8,length:2,width:2,radius:3},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8}}});qq=function(n){"use strict";return{hide:function(){return n.style.display="none",this},attach:function(t,i){return n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent&&n.attachEvent("on"+t,i),function(){qq(n).detach(t,i)}},detach:function(t,i){return n.removeEventListener?n.removeEventListener(t,i,!1):n.attachEvent&&n.detachEvent("on"+t,i),this},contains:function(t){return t?n===t?!0:n.contains?n.contains(t):!!(t.compareDocumentPosition(n)&8):!1},insertBefore:function(t){return t.parentNode.insertBefore(n,t),this},remove:function(){return n.parentNode.removeChild(n),this},css:function(t){if(n.style==null)throw new qq.Error("Can't apply style to node as it is not on the HTMLElement prototype chain!");return t.opacity!=null&&typeof n.style.opacity!="string"&&typeof n.filters!="undefined"&&(t.filter="alpha(opacity="+Math.round(100*t.opacity)+")"),qq.extend(n.style,t),this},hasClass:function(t){var i=new RegExp("(^| )"+t+"( |$)");return i.test(n.className)},addClass:function(t){return qq(n).hasClass(t)||(n.className+=" "+t),this},removeClass:function(t){var i=new RegExp("(^| )"+t+"( |$)");return n.className=n.className.replace(i," ").replace(/^\s+|\s+$/g,""),this},getByClass:function(t){var i,r=[];return n.querySelectorAll?n.querySelectorAll("."+t):(i=n.getElementsByTagName("*"),qq.each(i,function(n,i){qq(i).hasClass(t)&&r.push(i)}),r)},children:function(){for(var i=[],t=n.firstChild;t;)t.nodeType===1&&i.push(t),t=t.nextSibling;return i},setText:function(t){return n.innerText=t,n.textContent=t,this},clearText:function(){return qq(n).setText("")},hasAttribute:function(t){var i;return n.hasAttribute?n.hasAttribute(t)?/^false$/i.exec(n.getAttribute(t))==null:!1:(i=n[t],i===undefined)?!1:/^false$/i.exec(i)==null}}},function(){"use strict";qq.log=function(n,t){window.console&&(t&&t!=="info"?window.console[t]?window.console[t](n):window.console.log("<"+t+"> "+n):window.console.log(n))};qq.isObject=function(n){return n&&!n.nodeType&&Object.prototype.toString.call(n)==="[object Object]"};qq.isFunction=function(n){return typeof n=="function"};qq.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"||n&&window.ArrayBuffer&&n.buffer&&n.buffer.constructor===ArrayBuffer};qq.isItemList=function(n){return Object.prototype.toString.call(n)==="[object DataTransferItemList]"};qq.isNodeList=function(n){return Object.prototype.toString.call(n)==="[object NodeList]"||n.item&&n.namedItem};qq.isString=function(n){return Object.prototype.toString.call(n)==="[object String]"};qq.trimStr=function(n){return String.prototype.trim?n.trim():n.replace(/^\s+|\s+$/g,"")};qq.format=function(n){var r=Array.prototype.slice.call(arguments,1),t=n,i=t.indexOf("{}");return qq.each(r,function(n,r){var u=t.substring(0,i),f=t.substring(i+2);return t=u+r+f,i=t.indexOf("{}",i+r.length),i<0?!1:void 0}),t};qq.isFile=function(n){return window.File&&Object.prototype.toString.call(n)==="[object File]"};qq.isFileList=function(n){return window.FileList&&Object.prototype.toString.call(n)==="[object FileList]"};qq.isFileOrInput=function(n){return qq.isFile(n)||qq.isInput(n)};qq.isInput=function(n,t){var i=function(n){var i=n.toLowerCase();return t?i!=="file":i==="file"};return window.HTMLInputElement&&Object.prototype.toString.call(n)==="[object HTMLInputElement]"&&n.type&&i(n.type)?!0:n.tagName&&n.tagName.toLowerCase()==="input"&&n.type&&i(n.type)?!0:!1};qq.isBlob=function(n){if(window.Blob&&Object.prototype.toString.call(n)==="[object Blob]")return!0};qq.isXhrUploadSupported=function(){var n=document.createElement("input");return n.type="file",n.multiple!==undefined&&typeof File!="undefined"&&typeof FormData!="undefined"&&typeof qq.createXhrInstance().upload!="undefined"};qq.createXhrInstance=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(n){return qq.log("Neither XHR or ActiveX are supported!","error"),null}};qq.isFolderDropSupported=function(n){return n.items&&n.items.length>0&&n.items[0].webkitGetAsEntry};qq.isFileChunkingSupported=function(){return!qq.androidStock()&&qq.isXhrUploadSupported()&&(File.prototype.slice!==undefined||File.prototype.webkitSlice!==undefined||File.prototype.mozSlice!==undefined)};qq.sliceBlob=function(n,t,i){var r=n.slice||n.mozSlice||n.webkitSlice;return r.call(n,t,i)};qq.arrayBufferToHex=function(n){var t="",i=new Uint8Array(n);return qq.each(i,function(n,i){var r=i.toString(16);r.length<2&&(r="0"+r);t+=r}),t};qq.readBlobToHex=function(n,t,i){var f=qq.sliceBlob(n,t,t+i),r=new FileReader,u=new qq.Promise;return r.onload=function(){u.success(qq.arrayBufferToHex(r.result))},r.onerror=u.failure,r.readAsArrayBuffer(f),u};qq.extend=function(n,t,i){return qq.each(t,function(t,r){i&&qq.isObject(r)?(n[t]===undefined&&(n[t]={}),qq.extend(n[t],r,!0)):n[t]=r}),n};qq.override=function(n,t){var i={},r=t(i);return qq.each(r,function(t,r){n[t]!==undefined&&(i[t]=n[t]);n[t]=r}),n};qq.indexOf=function(n,t,i){if(n.indexOf)return n.indexOf(t,i);i=i||0;var r=n.length;for(i<0&&(i+=r);i<r;i+=1)if(n.hasOwnProperty(i)&&n[i]===t)return i;return-1};qq.getUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})};qq.ie=function(){return navigator.userAgent.indexOf("MSIE")!==-1};qq.ie7=function(){return navigator.userAgent.indexOf("MSIE 7")!==-1};qq.ie10=function(){return navigator.userAgent.indexOf("MSIE 10")!==-1};qq.ie11=function(){return navigator.userAgent.indexOf("Trident")!==-1&&navigator.userAgent.indexOf("rv:11")!==-1};qq.safari=function(){return navigator.vendor!==undefined&&navigator.vendor.indexOf("Apple")!==-1};qq.chrome=function(){return navigator.vendor!==undefined&&navigator.vendor.indexOf("Google")!==-1};qq.opera=function(){return navigator.vendor!==undefined&&navigator.vendor.indexOf("Opera")!==-1};qq.firefox=function(){return!qq.ie11()&&navigator.userAgent.indexOf("Mozilla")!==-1&&navigator.vendor!==undefined&&navigator.vendor===""};qq.windows=function(){return navigator.platform==="Win32"};qq.android=function(){return navigator.userAgent.toLowerCase().indexOf("android")!==-1};qq.androidStock=function(){return qq.android()&&navigator.userAgent.toLowerCase().indexOf("chrome")<0};qq.ios7=function(){return qq.ios()&&navigator.userAgent.indexOf(" OS 7_")!==-1};qq.ios=function(){return navigator.userAgent.indexOf("iPad")!==-1||navigator.userAgent.indexOf("iPod")!==-1||navigator.userAgent.indexOf("iPhone")!==-1};qq.preventDefault=function(n){n.preventDefault?n.preventDefault():n.returnValue=!1};qq.toElement=function(){var n=document.createElement("div");return function(t){n.innerHTML=t;var i=n.firstChild;return n.removeChild(i),i}}();qq.each=function(n,t){var i,r;if(n)if(window.Storage&&n.constructor===window.Storage){for(i=0;i<n.length;i++)if(r=t(n.key(i),n.getItem(n.key(i))),r===!1)break}else if(qq.isArray(n)||qq.isItemList(n)||qq.isNodeList(n)){for(i=0;i<n.length;i++)if(r=t(i,n[i]),r===!1)break}else if(qq.isString(n)){for(i=0;i<n.length;i++)if(r=t(i,n.charAt(i)),r===!1)break}else for(i in n)if(Object.prototype.hasOwnProperty.call(n,i)&&(r=t(i,n[i]),r===!1))break};qq.bind=function(n,t){if(qq.isFunction(n)){var i=Array.prototype.slice.call(arguments,2);return function(){var r=qq.extend([],i);return arguments.length&&(r=r.concat(Array.prototype.slice.call(arguments))),n.apply(t,r)}}throw new Error("first parameter must be a function!");};qq.obj2url=function(n,t,i){var r=[],u="&",f=function(n,i){var u=t?/\[\]$/.test(t)?t:t+"["+i+"]":i;u!=="undefined"&&i!=="undefined"&&r.push(typeof n=="object"?qq.obj2url(n,u,!0):Object.prototype.toString.call(n)==="[object Function]"?encodeURIComponent(u)+"="+encodeURIComponent(n()):encodeURIComponent(u)+"="+encodeURIComponent(n))};return!i&&t?(u=/\?/.test(t)?/\?$/.test(t)?"":"&":"?",r.push(t),r.push(qq.obj2url(n))):Object.prototype.toString.call(n)==="[object Array]"&&typeof n!="undefined"?qq.each(n,function(n,t){f(t,n)}):typeof n!="undefined"&&n!==null&&typeof n=="object"?qq.each(n,function(n,t){f(t,n)}):r.push(encodeURIComponent(t)+"="+encodeURIComponent(n)),t?r.join(u):r.join(u).replace(/^&/,"").replace(/%20/g,"+")};qq.obj2FormData=function(n,t,i){return t||(t=new FormData),qq.each(n,function(n,r){n=i?i+"["+n+"]":n;qq.isObject(r)?qq.obj2FormData(r,t,n):qq.isFunction(r)?t.append(n,r()):t.append(n,r)}),t};qq.obj2Inputs=function(n,t){var i;return t||(t=document.createElement("form")),qq.obj2FormData(n,{append:function(n,r){i=document.createElement("input");i.setAttribute("name",n);i.setAttribute("value",r);t.appendChild(i)}}),t};qq.parseJson=function(json){return window.JSON&&qq.isFunction(JSON.parse)?JSON.parse(json):eval("("+json+")")};qq.getExtension=function(n){var t=n.lastIndexOf(".")+1;if(t>0)return n.substr(t,n.length-t)};qq.getFilename=function(n){return qq.isInput(n)?n.value.replace(/.*(\/|\\)/,""):qq.isFile(n)&&n.fileName!==null&&n.fileName!==undefined?n.fileName:n.name};qq.DisposeSupport=function(){var n=[];return{dispose:function(){var t;do t=n.shift(),t&&t();while(t)},attach:function(){var n=arguments;this.addDisposer(qq(n[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))},addDisposer:function(t){n.push(t)}}}}(),function(){"use strict";qq.Error=function(n){this.message="[Fine Uploader "+qq.version+"] "+n};qq.Error.prototype=new Error}();qq.version="5.0.3";qq.supportedFeatures=function(){"use strict";function w(){var t=!0,n;try{n=document.createElement("input");n.type="file";qq(n).hide();n.disabled&&(t=!1)}catch(i){t=!1}return t}function b(){return(qq.chrome()||qq.opera())&&navigator.userAgent.match(/Chrome\/[2][1-9]|Chrome\/[3-9][0-9]/)!==undefined}function k(){return(qq.chrome()||qq.opera())&&navigator.userAgent.match(/Chrome\/[1][4-9]|Chrome\/[2-9][0-9]/)!==undefined}function y(){if(window.XMLHttpRequest){var n=qq.createXhrInstance();return n.withCredentials!==undefined}return!1}function p(){return window.XDomainRequest!==undefined}function d(){return y()?!0:p()}function g(){return document.createElement("input").webkitdirectory!==undefined}var t,u,n,f,i,e,o,s,h,c,l,a,r,v;return t=w(),n=t&&qq.isXhrUploadSupported(),u=n&&!qq.androidStock(),f=n&&b(),i=n&&qq.isFileChunkingSupported(),e=n&&i&&!!window.localStorage,o=n&&k(),s=t&&(window.postMessage!==undefined||n),c=y(),h=p(),l=d(),a=g(),r=n&&window.FileReader!==undefined,v=function(){return n?!qq.androidStock()&&!(qq.ios()&&navigator.userAgent.indexOf("CriOS")>=0):!1}(),{ajaxUploading:n,blobUploading:u,canDetermineSize:n,chunking:i,deleteFileCors:l,deleteFileCorsXdr:h,deleteFileCorsXhr:c,fileDrop:n,folderDrop:f,folderSelection:a,imagePreviews:r,imageValidation:r,itemSizeValidation:n,pause:i,progressBar:v,resume:e,scaling:r&&u,tiffPreviews:qq.safari(),unlimitedScaledImageSize:!qq.ios(),uploading:t,uploadCors:s,uploadCustomHeaders:n,uploadNonMultipart:n,uploadViaPaste:o}}();qq.isGenericPromise=function(n){"use strict";return!!(n&&n.then&&qq.isFunction(n.then))};qq.Promise=function(){"use strict";var t,n,u=[],f=[],i=[],r=0;qq.extend(this,{then:function(i,e){return r===0?(i&&u.push(i),e&&f.push(e)):r===-1?e&&e.apply(null,n):i&&i.apply(null,t),this},done:function(u){return r===0?i.push(u):u.apply(null,n===undefined?t:n),this},success:function(){return r=1,t=arguments,u.length&&qq.each(u,function(n,i){i.apply(null,t)}),i.length&&qq.each(i,function(n,i){i.apply(null,t)}),this},failure:function(){return r=-1,n=arguments,f.length&&qq.each(f,function(t,i){i.apply(null,n)}),i.length&&qq.each(i,function(t,i){i.apply(null,n)}),this}})};qq.BlobProxy=function(n,t){"use strict";qq.extend(this,{referenceBlob:n,create:function(){return t(n)}})};qq.UploadButton=function(n){"use strict";function f(){var n=document.createElement("input");return n.setAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME,u),t.multiple&&n.setAttribute("multiple",""),t.folders&&qq.supportedFeatures.folderSelection&&n.setAttribute("webkitdirectory",""),t.acceptFiles&&n.setAttribute("accept",t.acceptFiles),n.setAttribute("type","file"),n.setAttribute("name",t.name),qq(n).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),t.element.appendChild(n),r.attach(n,"change",function(){t.onChange(n)}),r.attach(n,"mouseover",function(){qq(t.element).addClass(t.hoverClass)}),r.attach(n,"mouseout",function(){qq(t.element).removeClass(t.hoverClass)}),r.attach(n,"focus",function(){qq(t.element).addClass(t.focusClass)}),r.attach(n,"blur",function(){qq(t.element).removeClass(t.focusClass)}),window.attachEvent&&n.setAttribute("tabIndex","-1"),n}var r=new qq.DisposeSupport,t={element:null,multiple:!1,acceptFiles:null,folders:!1,name:"qqfile",onChange:function(){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"},i,u;qq.extend(t,n);u=qq.getUniqueId();qq(t.element).css({position:"relative",overflow:"hidden",direction:"ltr"});i=f();qq.extend(this,{getInput:function(){return i},getButtonId:function(){return u},setMultiple:function(n){n!==t.multiple&&(n?i.setAttribute("multiple",""):i.removeAttribute("multiple"))},setAcceptFiles:function(n){n!==t.acceptFiles&&i.setAttribute("accept",n)},reset:function(){i.parentNode&&qq(i).remove();qq(t.element).removeClass(t.focusClass);i=f()}})};qq.UploadButton.BUTTON_ID_ATTR_NAME="qq-button-id";qq.UploadData=function(n){"use strict";function e(n){if(qq.isArray(n)){var i=[];return qq.each(n,function(n,r){i.push(t[r])}),i}return t[n]}function o(n){if(qq.isArray(n)){var i=[];return qq.each(n,function(n,u){i.push(t[r[u]])}),i}return t[r[n]]}function s(n){var r=[],u=[].concat(n);return qq.each(u,function(n,u){var f=i[u];f!==undefined&&qq.each(f,function(n,i){r.push(t[i])})}),r}var t=[],r={},i={},f={},u={};qq.extend(this,{addFile:function(e){var s=e.status||qq.status.SUBMITTING,o=t.push({name:e.name,originalName:e.name,uuid:e.uuid,size:e.size||-1,status:s})-1;e.batchId&&(t[o].batchId=e.batchId,u[e.batchId]===undefined&&(u[e.batchId]=[]),u[e.batchId].push(o));e.proxyGroupId&&(t[o].proxyGroupId=e.proxyGroupId,f[e.proxyGroupId]===undefined&&(f[e.proxyGroupId]=[]),f[e.proxyGroupId].push(o));t[o].id=o;r[e.uuid]=o;i[s]===undefined&&(i[s]=[]);i[s].push(o);n.onStatusChange(o,null,s);return o},retrieve:function(n){if(qq.isObject(n)&&t.length){if(n.id!==undefined)return e(n.id);if(n.uuid!==undefined)return o(n.uuid);if(n.status)return s(n.status)}else return qq.extend([],t,!0)},reset:function(){t=[];r={};i={};u={}},setStatus:function(r,u){var f=t[r].status,e=qq.indexOf(i[f],r);i[f].splice(e,1);t[r].status=u;i[u]===undefined&&(i[u]=[]);i[u].push(r);n.onStatusChange(r,f,u)},uuidChanged:function(n,i){var u=t[n].uuid;t[n].uuid=i;r[i]=n;delete r[u]},updateName:function(n,i){t[n].name=i},updateSize:function(n,i){t[n].size=i},setParentId:function(n,i){t[n].parentId=i},getIdsInProxyGroup:function(n){var i=t[n].proxyGroupId;return i?f[i]:[]},getIdsInBatch:function(n){var i=t[n].batchId;return u[i]}})};qq.status={SUBMITTING:"submitting",SUBMITTED:"submitted",REJECTED:"rejected",QUEUED:"queued",CANCELED:"canceled",PAUSED:"paused",UPLOADING:"uploading",UPLOAD_RETRYING:"retrying upload",UPLOAD_SUCCESSFUL:"upload successful",UPLOAD_FAILED:"upload failed",DELETE_FAILED:"delete failed",DELETING:"deleting",DELETED:"deleted"},function(){"use strict";qq.basePublicApi={addBlobs:function(n,t,i){if(!qq.supportedFeatures.blobUploading)throw new qq.Error("Blob uploading is not supported in this browser!");if(n){var e=[].concat(n),u=[],f=this._storedIds.length===0?qq.getUniqueId():this._currentBatchId,r=this;this._currentBatchId=f;qq.each(e,function(n,t){var i;qq.isBlob(t)&&!qq.isFileOrInput(t)?i={blob:t,name:r._options.blobs.defaultName}:qq.isObject(t)&&t.blob&&t.name?i=t:r.log("addBlobs: entry at index "+n+" is not a Blob or a BlobData object","error");i&&r._handleNewFile(i,f,u)});this._prepareItemsForUpload(u,t,i)}else this.log("undefined or non-array parameter passed into addBlobs","error")},addFiles:function(n,t,i){var u=[],o=this._storedIds.length===0?qq.getUniqueId():this._currentBatchId,f,r,e;if(this._currentBatchId=o,n){for(qq.isFileList(n)||(n=[].concat(n)),f=0;f<n.length;f+=1)if(r=n[f],qq.isFileOrInput(r))if(qq.isInput(r)&&qq.supportedFeatures.ajaxUploading)for(e=0;e<r.files.length;e++)this._handleNewFile(r.files[e],o,u);else this._handleNewFile(r,o,u);else this.log(r+" is not a File or INPUT element!  Ignoring!","warn");this.log("Received "+u.length+" files or inputs.");this._prepareItemsForUpload(u,t,i)}},cancel:function(n){this._handler.cancel(n)},cancelAll:function(){var n=[],t=this;qq.extend(n,this._storedIds);qq.each(n,function(n,i){t.cancel(i)});this._handler.cancelAll()},clearStoredFiles:function(){this._storedIds=[]},continueUpload:function(n){var t=this._uploadData.retrieve({id:n});return!qq.supportedFeatures.pause||!this._options.chunking.enabled?!1:t.status===qq.status.PAUSED?(this.log(qq.format("Paused file ID {} ({}) will be continued.  Not paused.",n,this.getName(n))),this._uploadFile(n),!0):(this.log(qq.format("Ignoring continue for file ID {} ({}).  Not paused.",n,this.getName(n)),"error"),!1)},deleteFile:function(n){return this._onSubmitDelete(n)},doesExist:function(n){return this._handler.isValid(n)},drawThumbnail:function(n,t,i,r){var u=new qq.Promise,f,e;return this._imageGenerator?(f=this._thumbnailUrls[n],e={scale:i>0,maxSize:i>0?i:null},!r&&qq.supportedFeatures.imagePreviews&&(f=this.getFile(n)),f==null?u.failure({container:t,error:"File or URL not found."}):this._imageGenerator.generate(f,t,e).then(function(n){u.success(n)},function(n,t){u.failure({container:n,error:t||"Problem generating thumbnail"})})):u.failure({container:t,error:"Missing image generator module"}),u},getButton:function(n){return this._getButton(this._buttonIdsForFileIds[n])},getFile:function(n){return this._handler.getFile(n)||null},getInProgress:function(){return this._uploadData.retrieve({status:[qq.status.UPLOADING,qq.status.UPLOAD_RETRYING,qq.status.QUEUED]}).length},getName:function(n){return this._uploadData.retrieve({id:n}).name},getParentId:function(n){var t=this.getUploads({id:n}),i=null;return t&&t.parentId!==undefined&&(i=t.parentId),i},getResumableFilesData:function(){return this._handler.getResumableFilesData()},getSize:function(n){return this._uploadData.retrieve({id:n}).size},getNetUploads:function(){return this._netUploaded},getRemainingAllowedItems:function(){var n=this._options.validation.itemLimit;return n>0?this._options.validation.itemLimit-this._netUploadedOrQueued:null},getUploads:function(n){return this._uploadData.retrieve(n)},getUuid:function(n){return this._uploadData.retrieve({id:n}).uuid},log:function(n,t){this._options.debug&&(!t||t==="info")?qq.log("[Fine Uploader "+qq.version+"] "+n):t&&t!=="info"&&qq.log("[Fine Uploader "+qq.version+"] "+n,t)},pauseUpload:function(n){var t=this._uploadData.retrieve({id:n});if(!qq.supportedFeatures.pause||!this._options.chunking.enabled)return!1;if(qq.indexOf([qq.status.UPLOADING,qq.status.UPLOAD_RETRYING],t.status)>=0){if(this._handler.pause(n))return this._uploadData.setStatus(n,qq.status.PAUSED),!0;this.log(qq.format("Unable to pause file ID {} ({}).",n,this.getName(n)),"error")}else this.log(qq.format("Ignoring pause for file ID {} ({}).  Not in progress.",n,this.getName(n)),"error");return!1},reset:function(){this.log("Resetting uploader...");this._handler.reset();this._storedIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._thumbnailUrls=[];qq.each(this._buttons,function(n,t){t.reset()});this._paramsStore.reset();this._endpointStore.reset();this._netUploadedOrQueued=0;this._netUploaded=0;this._uploadData.reset();this._buttonIdsForFileIds=[];this._pasteHandler&&this._pasteHandler.reset();this._options.session.refreshOnReset&&this._refreshSessionData();this._succeededSinceLastAllComplete=[];this._failedSinceLastAllComplete=[];this._totalProgress&&this._totalProgress.reset()},retry:function(n){return this._manualRetry(n)},scaleImage:function(n,t){var i=this;return qq.Scaler.prototype.scaleImage(n,t,{log:qq.bind(i.log,i),getFile:qq.bind(i.getFile,i),uploadData:i._uploadData})},setCustomHeaders:function(n,t){this._customHeadersStore.set(n,t)},setDeleteFileCustomHeaders:function(n,t){this._deleteFileCustomHeadersStore.set(n,t)},setDeleteFileEndpoint:function(n,t){this._deleteFileEndpointStore.set(n,t)},setDeleteFileParams:function(n,t){this._deleteFileParamsStore.set(n,t)},setEndpoint:function(n,t){this._endpointStore.set(n,t)},setName:function(n,t){this._uploadData.updateName(n,t)},setParams:function(n,t){this._paramsStore.set(n,t)},setUuid:function(n,t){return this._uploadData.uuidChanged(n,t)},uploadStoredFiles:function(){var n;if(this._storedIds.length===0)this._itemError("noFilesError");else while(this._storedIds.length)n=this._storedIds.shift(),this._uploadFile(n)}};qq.basePrivateApi={_addCannedFile:function(n){var t=this._uploadData.addFile({uuid:n.uuid,name:n.name,size:n.size,status:qq.status.UPLOAD_SUCCESSFUL});return n.deleteFileEndpoint&&this.setDeleteFileEndpoint(n.deleteFileEndpoint,t),n.deleteFileParams&&this.setDeleteFileParams(n.deleteFileParams,t),n.thumbnailUrl&&(this._thumbnailUrls[t]=n.thumbnailUrl),this._netUploaded++,this._netUploadedOrQueued++,t},_annotateWithButtonId:function(n,t){qq.isFile(n)&&(n.qqButtonId=this._getButtonId(t))},_batchError:function(n){this._options.callbacks.onError(null,null,n,undefined)},_createDeleteHandler:function(){var n=this;return new qq.DeleteFileAjaxRequester({method:this._options.deleteFile.method.toUpperCase(),maxConnections:this._options.maxConnections,uuidParamName:this._options.request.uuidName,customHeaders:this._deleteFileCustomHeadersStore,paramsStore:this._deleteFileParamsStore,endpointStore:this._deleteFileEndpointStore,demoMode:this._options.demoMode,cors:this._options.cors,log:qq.bind(n.log,n),onDelete:function(t){n._onDelete(t);n._options.callbacks.onDelete(t)},onDeleteComplete:function(t,i,r){n._onDeleteComplete(t,i,r);n._options.callbacks.onDeleteComplete(t,i,r)}})},_createPasteHandler:function(){var n=this;return new qq.PasteSupport({targetElement:this._options.paste.targetElement,callbacks:{log:qq.bind(n.log,n),pasteReceived:function(t){n._handleCheckedCallback({name:"onPasteReceived",callback:qq.bind(n._options.callbacks.onPasteReceived,n,t),onSuccess:qq.bind(n._handlePasteSuccess,n,t),identifier:"pasted image"})}}})},_createStore:function(n,t){var i={},f=n,r={},u=function(n){return qq.isObject(n)?qq.extend({},n):n},e=function(){return qq.isFunction(t)?t():t},o=function(n,i){t&&qq.isObject(i)&&qq.extend(i,e());r[n]&&qq.extend(i,r[n])};return{set:function(n,t){t==null?(i={},f=u(n)):i[t]=u(n)},get:function(n){var t;return t=n!=null&&i[n]?i[n]:u(f),o(n,t),u(t)},addReadOnly:function(n,t){qq.isObject(i)&&(r[n]=r[n]||{},qq.extend(r[n],t))},remove:function(n){return delete i[n]},reset:function(){i={};r={};f=n}}},_createUploadDataTracker:function(){var n=this;return new qq.UploadData({getName:function(t){return n.getName(t)},getUuid:function(t){return n.getUuid(t)},getSize:function(t){return n.getSize(t)},onStatusChange:function(t,i,r){n._onUploadStatusChange(t,i,r);n._options.callbacks.onStatusChange(t,i,r);n._maybeAllComplete(t,r);n._totalProgress&&setTimeout(function(){n._totalProgress.onStatusChange(t,i,r)},0)}})},_createUploadButton:function(n){function f(){return qq.supportedFeatures.ajaxUploading?qq.ios7()&&t._isAllowedExtension(u,".mov")?!1:n.multiple===undefined?t._options.multiple:n.multiple:!1}var t=this,r=n.accept||this._options.validation.acceptFiles,u=n.allowedExtensions||this._options.validation.allowedExtensions,i=new qq.UploadButton({element:n.element,folders:n.folders,name:this._options.request.inputName,multiple:f(),acceptFiles:r,onChange:function(n){t._onInputChange(n)},hoverClass:this._options.classes.buttonHover,focusClass:this._options.classes.buttonFocus});return this._disposeSupport.addDisposer(function(){i.dispose()}),t._buttons.push(i),i},_createUploadHandler:function(n,t){var i=this,r={},u={debug:this._options.debug,maxConnections:this._options.maxConnections,cors:this._options.cors,demoMode:this._options.demoMode,paramsStore:this._paramsStore,endpointStore:this._endpointStore,chunking:this._options.chunking,resume:this._options.resume,blobs:this._options.blobs,log:qq.bind(i.log,i),preventRetryParam:this._options.retry.preventRetryResponseProperty,onProgress:function(n,t,u,f){if(r[n]){if(r[n].loaded!==u||r[n].total!==f){i._onProgress(n,t,u,f);i._options.callbacks.onProgress(n,t,u,f)}}else{i._onProgress(n,t,u,f);i._options.callbacks.onProgress(n,t,u,f)}r[n]={loaded:u,total:f}},onComplete:function(n,t,u,f){var e,o;if(delete r[n],e=i.getUploads({id:n}).status,e!==qq.status.UPLOAD_SUCCESSFUL&&e!==qq.status.UPLOAD_FAILED)if(o=i._onComplete(n,t,u,f),o instanceof qq.Promise)o.done(function(){i._options.callbacks.onComplete(n,t,u,f)});else i._options.callbacks.onComplete(n,t,u,f)},onCancel:function(n,t,r){var u=new qq.Promise;return i._handleCheckedCallback({name:"onCancel",callback:qq.bind(i._options.callbacks.onCancel,i,n,t),onFailure:u.failure,onSuccess:function(){r.then(function(){i._onCancel(n,t)});u.success()},identifier:n}),u},onUploadPrep:qq.bind(this._onUploadPrep,this),onUpload:function(n,t){i._onUpload(n,t);i._options.callbacks.onUpload(n,t)},onUploadChunk:function(n,t,r){i._onUploadChunk(n,r);i._options.callbacks.onUploadChunk(n,t,r)},onUploadChunkSuccess:function(){i._options.callbacks.onUploadChunkSuccess.apply(i,arguments)},onResume:function(n,t,r){return i._options.callbacks.onResume(n,t,r)},onAutoRetry:function(){return i._onAutoRetry.apply(i,arguments)},onUuidChanged:function(n,t){i.log("Server requested UUID change from '"+i.getUuid(n)+"' to '"+t+"'");i.setUuid(n,t)},getName:qq.bind(i.getName,i),getUuid:qq.bind(i.getUuid,i),getSize:qq.bind(i.getSize,i),setSize:qq.bind(i._setSize,i),getDataByUuid:function(n){return i.getUploads({uuid:n})},isQueued:function(n){var t=i.getUploads({id:n}).status;return t===qq.status.QUEUED||t===qq.status.SUBMITTED||t===qq.status.UPLOAD_RETRYING||t===qq.status.PAUSED},getIdsInProxyGroup:i._uploadData.getIdsInProxyGroup,getIdsInBatch:i._uploadData.getIdsInBatch};return qq.each(this._options.request,function(n,t){u[n]=t}),u.customHeaders=this._customHeadersStore,n&&qq.each(n,function(n,t){u[n]=t}),new qq.UploadHandlerController(u,t)},_fileOrBlobRejected:function(n){this._netUploadedOrQueued--;this._uploadData.setStatus(n,qq.status.REJECTED)},_formatSize:function(n){var t=-1;do n=n/1e3,t++;while(n>999);return Math.max(n,.1).toFixed(1)+this._options.text.sizeSymbols[t]},_generateExtraButtonSpecs:function(){var n=this;this._extraButtonSpecs={};qq.each(this._options.extraButtons,function(t,i){var r=i.multiple,f=qq.extend({},n._options.validation,!0),u=qq.extend({},i);r===undefined&&(r=n._options.multiple);u.validation&&qq.extend(f,i.validation,!0);qq.extend(u,{multiple:r,validation:f},!0);n._initExtraButton(u)})},_getButton:function(n){var t=this._extraButtonSpecs[n];return t?t.element:n===this._defaultButtonId?this._options.button:void 0},_getButtonId:function(n){var r,i,t=n;if(t instanceof qq.BlobProxy&&(t=t.referenceBlob),t&&!qq.isBlob(t)){if(qq.isFile(t))return t.qqButtonId;if(t.tagName.toLowerCase()==="input"&&t.type.toLowerCase()==="file")return t.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME);if(r=t.getElementsByTagName("input"),qq.each(r,function(n,t){if(t.getAttribute("type")==="file")return i=t,!1}),i)return i.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME)}},_getNotFinished:function(){return this._uploadData.retrieve({status:[qq.status.UPLOADING,qq.status.UPLOAD_RETRYING,qq.status.QUEUED,qq.status.SUBMITTING,qq.status.SUBMITTED,qq.status.PAUSED]}).length},_getValidationBase:function(n){var t=this._extraButtonSpecs[n];return t?t.validation:this._options.validation},_getValidationDescriptor:function(n){return n.file instanceof qq.BlobProxy?{name:qq.getFilename(n.file.referenceBlob),size:n.file.referenceBlob.size}:{name:this.getUploads({id:n.id}).name,size:this.getUploads({id:n.id}).size}},_getValidationDescriptors:function(n){var i=this,t=[];return qq.each(n,function(n,r){t.push(i._getValidationDescriptor(r))}),t},_handleCameraAccess:function(){if(this._options.camera.ios&&qq.ios()){var i="image/*;capture=camera",r=this._options.camera.button,t=r?this._getButtonId(r):this._defaultButtonId,n=this._options;t&&t!==this._defaultButtonId&&(n=this._extraButtonSpecs[t]);n.multiple=!1;n.validation.acceptFiles===null?n.validation.acceptFiles=i:n.validation.acceptFiles+=","+i;qq.each(this._buttons,function(i,r){if(r.getButtonId()===t)return r.setMultiple(n.multiple),r.setAcceptFiles(n.acceptFiles),!1})}},_handleCheckedCallback:function(n){var i=this,t=n.callback();if(qq.isGenericPromise(t))return this.log(n.name+" - waiting for "+n.name+" promise to be fulfilled for "+n.identifier),t.then(function(t){i.log(n.name+" promise success for "+n.identifier);n.onSuccess(t)},function(){n.onFailure?(i.log(n.name+" promise failure for "+n.identifier),n.onFailure()):i.log(n.name+" promise failure for "+n.identifier)});if(t!==!1)n.onSuccess(t);else n.onFailure?(this.log(n.name+" - return value was 'false' for "+n.identifier+".  Invoking failure callback."),n.onFailure()):this.log(n.name+" - return value was 'false' for "+n.identifier+".  Will not proceed.");return t},_handleNewFile:function(n,t,i){var r=this,e=qq.getUniqueId(),f=-1,o=qq.getFilename(n),u=n.blob||n,s=this._customNewFileHandler?this._customNewFileHandler:qq.bind(r._handleNewFileGeneric,r);!qq.isInput(u)&&u.size>=0&&(f=u.size);s(u,o,e,f,i,t,this._options.request.uuidName,{uploadData:r._uploadData,paramsStore:r._paramsStore,addFileToHandler:function(n,t){r._handler.add(n,t);r._netUploadedOrQueued++;r._trackButton(n)}})},_handleNewFileGeneric:function(n,t,i,r,u,f){var e=this._uploadData.addFile({uuid:i,name:t,size:r,batchId:f});this._handler.add(e,n);this._trackButton(e);this._netUploadedOrQueued++;u.push({id:e,file:n})},_handlePasteSuccess:function(n,t){var r=n.type.split("/")[1],i=t;i==null&&(i=this._options.paste.defaultName);i+="."+r;this.addBlobs({name:i,blob:n})},_initExtraButton:function(n){var t=this._createUploadButton({element:n.element,multiple:n.multiple,accept:n.validation.acceptFiles,folders:n.folders,allowedExtensions:n.validation.allowedExtensions});this._extraButtonSpecs[t.getButtonId()]=n},_initFormSupportAndParams:function(){this._formSupport=qq.FormSupport&&new qq.FormSupport(this._options.form,qq.bind(this.uploadStoredFiles,this),qq.bind(this.log,this));this._formSupport&&this._formSupport.attachedToForm?(this._paramsStore=this._createStore(this._options.request.params,this._formSupport.getFormInputsAsObject),this._options.autoUpload=this._formSupport.newAutoUpload,this._formSupport.newEndpoint&&(this._options.request.endpoint=this._formSupport.newEndpoint)):this._paramsStore=this._createStore(this._options.request.params)},_isDeletePossible:function(){return!qq.DeleteFileAjaxRequester||!this._options.deleteFile.enabled?!1:this._options.cors.expected?qq.supportedFeatures.deleteFileCorsXhr?!0:qq.supportedFeatures.deleteFileCorsXdr&&this._options.cors.allowXdr?!0:!1:!0},_isAllowedExtension:function(n,t){var i=!1;return n.length?(qq.each(n,function(n,r){if(qq.isString(r)){var u=new RegExp("\\."+r+"$","i");if(t.match(u)!=null)return i=!0,!1}}),i):!0},_itemError:function(n,t,i){function u(n,t){r=r.replace(n,t)}var r=this._options.messages[n],o=[],s=[].concat(t),h=s[0],l=this._getButtonId(i),f=this._getValidationBase(l),c,e;qq.each(f.allowedExtensions,function(n,t){qq.isString(t)&&o.push(t)});c=o.join(", ").toLowerCase();u("{file}",this._options.formatFileName(h));u("{extensions}",c);u("{sizeLimit}",this._formatSize(f.sizeLimit));u("{minSizeLimit}",this._formatSize(f.minSizeLimit));e=r.match(/(\{\w+\})/g);e!==null&&qq.each(e,function(n,t){u(t,s[n])});this._options.callbacks.onError(null,h,r,undefined);return r},_manualRetry:function(n,t){if(this._onBeforeManualRetry(n))return this._netUploadedOrQueued++,this._uploadData.setStatus(n,qq.status.UPLOAD_RETRYING),t?t(n):this._handler.retry(n),!0},_maybeAllComplete:function(n,t){var i=this,r=this._getNotFinished();t===qq.status.UPLOAD_SUCCESSFUL?this._succeededSinceLastAllComplete.push(n):t===qq.status.UPLOAD_FAILED&&this._failedSinceLastAllComplete.push(n);r===0&&(this._succeededSinceLastAllComplete.length||this._failedSinceLastAllComplete.length)&&setTimeout(function(){i._onAllComplete(i._succeededSinceLastAllComplete,i._failedSinceLastAllComplete)},0)},_maybeParseAndSendUploadError:function(n,t,i,r){if(!i.success)if(r&&r.status!==200&&!i.error)this._options.callbacks.onError(n,t,"XHR returned response code "+r.status,r);else{var u=i.error?i.error:this._options.text.defaultResponseError;this._options.callbacks.onError(n,t,u,r)}},_maybeProcessNextItemAfterOnValidateCallback:function(n,t,i,r,u){var f=this;if(t.length>i)if(n||!this._options.validation.stopOnFirstInvalidFile)setTimeout(function(){var n=f._getValidationDescriptor(t[i]);f._handleCheckedCallback({name:"onValidate",callback:qq.bind(f._options.callbacks.onValidate,f,t[i].file),onSuccess:qq.bind(f._onValidateCallbackSuccess,f,t,i,r,u),onFailure:qq.bind(f._onValidateCallbackFailure,f,t,i,r,u),identifier:"Item '"+n.name+"', size: "+n.size})},0);else if(!n)for(;i<t.length;i++)f._fileOrBlobRejected(t[i].id)},_onAllComplete:function(n,t){this._totalProgress&&this._totalProgress.onAllComplete(n,t,this._preventRetries);this._options.callbacks.onAllComplete(qq.extend([],n),qq.extend([],t));this._succeededSinceLastAllComplete=[];this._failedSinceLastAllComplete=[]},_onAutoRetry:function(n,t,i,r,u){var f=this;if(f._preventRetries[n]=i[f._options.retry.preventRetryResponseProperty],f._shouldAutoRetry(n,t,i)){f._maybeParseAndSendUploadError.apply(f,arguments);f._options.callbacks.onAutoRetry(n,t,f._autoRetries[n]);return f._onBeforeAutoRetry(n,t),f._retryTimeouts[n]=setTimeout(function(){f.log("Retrying "+t+"...");f._uploadData.setStatus(n,qq.status.UPLOAD_RETRYING);u?u(n):f._handler.retry(n)},f._options.retry.autoAttemptDelay*1e3),!0}},_onBeforeAutoRetry:function(n,t){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+t+"...")},_onBeforeManualRetry:function(n){var i=this._options.validation.itemLimit,t;return this._preventRetries[n]?(this.log("Retries are forbidden for id "+n,"warn"),!1):this._handler.isValid(n)?(t=this.getName(n),this._options.callbacks.onManualRetry(n,t)===!1)?!1:i>0&&this._netUploadedOrQueued+1>i?(this._itemError("retryFailTooManyItems"),!1):(this.log("Retrying upload for '"+t+"' (id: "+n+")..."),!0):(this.log("'"+n+"' is not a valid file ID","error"),!1)},_onCancel:function(n){this._netUploadedOrQueued--;clearTimeout(this._retryTimeouts[n]);var t=qq.indexOf(this._storedIds,n);!this._options.autoUpload&&t>=0&&this._storedIds.splice(t,1);this._uploadData.setStatus(n,qq.status.CANCELED)},_onComplete:function(n,t,i,r){return i.success?(i.thumbnailUrl&&(this._thumbnailUrls[n]=i.thumbnailUrl),this._netUploaded++,this._uploadData.setStatus(n,qq.status.UPLOAD_SUCCESSFUL)):(this._netUploadedOrQueued--,this._uploadData.setStatus(n,qq.status.UPLOAD_FAILED),i[this._options.retry.preventRetryResponseProperty]===!0&&(this._preventRetries[n]=!0)),this._maybeParseAndSendUploadError(n,t,i,r),i.success?!0:!1},_onDelete:function(n){this._uploadData.setStatus(n,qq.status.DELETING)},_onDeleteComplete:function(n,t,i){var r=this.getName(n);if(i)if(this._uploadData.setStatus(n,qq.status.DELETE_FAILED),this.log("Delete request for '"+r+"' has failed.","error"),t.withCredentials===undefined)this._options.callbacks.onError(n,r,"Delete request failed",t);else this._options.callbacks.onError(n,r,"Delete request failed with response code "+t.status,t);else this._netUploadedOrQueued--,this._netUploaded--,this._handler.expunge(n),this._uploadData.setStatus(n,qq.status.DELETED),this.log("Delete request for '"+r+"' has succeeded.")},_onInputChange:function(n){var t;if(qq.supportedFeatures.ajaxUploading){for(t=0;t<n.files.length;t++)this._annotateWithButtonId(n.files[t],n);this.addFiles(n.files)}else n.value.length>0&&this.addFiles(n);qq.each(this._buttons,function(n,t){t.reset()})},_onProgress:function(n,t,i,r){this._totalProgress&&this._totalProgress.onIndividualProgress(n,i,r)},_onSubmit:function(){},_onSubmitCallbackSuccess:function(n){this._onSubmit.apply(this,arguments);this._uploadData.setStatus(n,qq.status.SUBMITTED);this._onSubmitted.apply(this,arguments);this._options.callbacks.onSubmitted.apply(this,arguments);this._options.autoUpload?this._uploadFile(n):this._storeForLater(n)},_onSubmitDelete:function(n,t,i){var r=this.getUuid(n),u;return t&&(u=qq.bind(t,this,n,r,i)),this._isDeletePossible()?(this._handleCheckedCallback({name:"onSubmitDelete",callback:qq.bind(this._options.callbacks.onSubmitDelete,this,n),onSuccess:u||qq.bind(this._deleteHandler.sendDelete,this,n,r,i),identifier:n}),!0):(this.log("Delete request ignored for ID "+n+", delete feature is disabled or request not possible due to CORS on a user agent that does not support pre-flighting.","warn"),!1)},_onSubmitted:function(){},_onTotalProgress:function(n,t){this._options.callbacks.onTotalProgress(n,t)},_onUploadPrep:function(){},_onUpload:function(n){this._uploadData.setStatus(n,qq.status.UPLOADING)},_onUploadChunk:function(){},_onUploadStatusChange:function(n,t,i){i===qq.status.PAUSED&&clearTimeout(this._retryTimeouts[n])},_onValidateBatchCallbackFailure:function(n){var t=this;qq.each(n,function(n,i){t._fileOrBlobRejected(i.id)})},_onValidateBatchCallbackSuccess:function(n,t,i,r,u){var e,f=this._options.validation.itemLimit,o=this._netUploadedOrQueued;f===0||o<=f?t.length>0?this._handleCheckedCallback({name:"onValidate",callback:qq.bind(this._options.callbacks.onValidate,this,n[0],u),onSuccess:qq.bind(this._onValidateCallbackSuccess,this,t,0,i,r),onFailure:qq.bind(this._onValidateCallbackFailure,this,t,0,i,r),identifier:"Item '"+t[0].file.name+"', size: "+t[0].file.size}):this._itemError("noFilesError"):(this._onValidateBatchCallbackFailure(t),e=this._options.messages.tooManyItemsError.replace(/\{netItems\}/g,o).replace(/\{itemLimit\}/g,f),this._batchError(e))},_onValidateCallbackFailure:function(n,t,i,r){var u=t+1;this._fileOrBlobRejected(n[0].id,n[0].file.name);this._maybeProcessNextItemAfterOnValidateCallback(!1,n,u,i,r)},_onValidateCallbackSuccess:function(n,t,i,r){var u=this,f=t+1,e=this._getValidationDescriptor(n[t]);this._validateFileOrBlobData(n[t],e).then(function(){u._upload(n[t].id,i,r);u._maybeProcessNextItemAfterOnValidateCallback(!0,n,f,i,r)},function(){u._maybeProcessNextItemAfterOnValidateCallback(!1,n,f,i,r)})},_prepareItemsForUpload:function(n,t,i){if(n.length===0){this._itemError("noFilesError");return}var r=this._getValidationDescriptors(n),f=this._getButtonId(n[0].file),u=this._getButton(f);this._handleCheckedCallback({name:"onValidateBatch",callback:qq.bind(this._options.callbacks.onValidateBatch,this,r,u),onSuccess:qq.bind(this._onValidateBatchCallbackSuccess,this,r,n,t,i,u),onFailure:qq.bind(this._onValidateBatchCallbackFailure,this,n),identifier:"batch validation"})},_preventLeaveInProgress:function(){var n=this;this._disposeSupport.attach(window,"beforeunload",function(t){if(n.getInProgress())return t=t||window.event,t.returnValue=n._options.messages.onLeave,n._options.messages.onLeave})},_refreshSessionData:function(){var t=this,n=this._options.session;qq.Session&&this._options.session.endpoint!=null&&(this._session||(qq.extend(n,this._options.cors),n.log=qq.bind(this.log,this),n.addFileRecord=qq.bind(this._addCannedFile,this),this._session=new qq.Session(n)),setTimeout(function(){t._session.refresh().then(function(n,i){t._options.callbacks.onSessionRequestComplete(n,!0,i)},function(n,i){t._options.callbacks.onSessionRequestComplete(n,!1,i)})},0))},_setSize:function(n,t){this._uploadData.updateSize(n,t);this._totalProgress&&this._totalProgress.onNewSize(n)},_shouldAutoRetry:function(n){var t=this._uploadData.retrieve({id:n});return!this._preventRetries[n]&&this._options.retry.enableAuto&&t.status!==qq.status.PAUSED&&(this._autoRetries[n]===undefined&&(this._autoRetries[n]=0),this._autoRetries[n]<this._options.retry.maxAutoAttempts)?(this._autoRetries[n]+=1,!0):!1},_storeForLater:function(n){this._storedIds.push(n)},_trackButton:function(n){var t;t=qq.supportedFeatures.ajaxUploading?this._handler.getFile(n).qqButtonId:this._getButtonId(this._handler.getInput(n));t&&(this._buttonIdsForFileIds[n]=t)},_upload:function(n,t,i){var r=this.getName(n);t&&this.setParams(t,n);i&&this.setEndpoint(i,n);this._handleCheckedCallback({name:"onSubmit",callback:qq.bind(this._options.callbacks.onSubmit,this,n,r),onSuccess:qq.bind(this._onSubmitCallbackSuccess,this,n,r),onFailure:qq.bind(this._fileOrBlobRejected,this,n,r),identifier:n})},_uploadFile:function(n){this._handler.upload(n)||this._uploadData.setStatus(n,qq.status.QUEUED)},_validateFileOrBlobData:function(n,t){var o=this,r=function(){return n.file instanceof qq.BlobProxy?n.file.referenceBlob:n.file}(),u=t.name,f=t.size,s=this._getButtonId(n.file),e=this._getValidationBase(s),i=new qq.Promise;return(i.then(function(){},function(){o._fileOrBlobRejected(n.id,u)}),qq.isFileOrInput(r)&&!this._isAllowedExtension(e.allowedExtensions,u))?(this._itemError("typeError",u,r),i.failure()):f===0?(this._itemError("emptyError",u,r),i.failure()):f>0&&e.sizeLimit&&f>e.sizeLimit?(this._itemError("sizeError",u,r),i.failure()):f>0&&f<e.minSizeLimit?(this._itemError("minSizeError",u,r),i.failure()):(qq.ImageValidation&&qq.supportedFeatures.imagePreviews&&qq.isFile(r)?new qq.ImageValidation(r,qq.bind(o.log,o)).validate(e.image).then(i.success,function(n){o._itemError(n+"ImageError",u,r);i.failure()}):i.success(),i)},_wrapCallbacks:function(){var n,t,i;n=this;t=function(t,i,r){var u;try{return i.apply(n,r)}catch(f){u=f.message||f.toString();n.log("Caught exception in '"+t+"' callback - "+u,"error")}};for(i in this._options.callbacks)(function(){var r,u;r=i;u=n._options.callbacks[r];n._options.callbacks[r]=function(){return t(r,u,arguments)}})()}}}(),function(){"use strict";qq.FineUploaderBasic=function(n){var t=this;this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,request:{endpoint:"/server/upload",params:{},paramsInBody:!0,customHeaders:{},forceMultipart:!0,inputName:"qqfile",uuidName:"qquuid",totalFileSizeName:"qqtotalfilesize",filenameParam:"qqfilename"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,itemLimit:0,stopOnFirstInvalidFile:!0,acceptFiles:null,image:{maxHeight:0,maxWidth:0,minHeight:0,minWidth:0}},callbacks:{onSubmit:function(){},onSubmitted:function(){},onComplete:function(){},onAllComplete:function(){},onCancel:function(){},onUpload:function(){},onUploadChunk:function(){},onUploadChunkSuccess:function(){},onResume:function(){},onProgress:function(){},onTotalProgress:function(){},onError:function(){},onAutoRetry:function(){},onManualRetry:function(){},onValidateBatch:function(){},onValidate:function(){},onSubmitDelete:function(){},onDelete:function(){},onDeleteComplete:function(){},onPasteReceived:function(){},onStatusChange:function(){},onSessionRequestComplete:function(){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",tooManyItemsError:"Too many items ({netItems}) would be uploaded.  Item limit is {itemLimit}.",maxHeightImageError:"Image is too tall.",maxWidthImageError:"Image is too wide.",minHeightImageError:"Image is not tall enough.",minWidthImageError:"Image is not wide enough.",retryFailTooManyItems:"Retry failed - you have reached your file limit.",onLeave:"The files are being uploaded, if you leave now the upload will be canceled."},retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"},classes:{buttonHover:"qq-upload-button-hover",buttonFocus:"qq-upload-button-focus"},chunking:{enabled:!1,concurrent:{enabled:!1},paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalFileSize:"qqtotalfilesize",totalParts:"qqtotalparts"},partSize:2e6,success:{endpoint:null}},resume:{enabled:!1,recordsExpireIn:7,paramNames:{resuming:"qqresume"}},formatFileName:function(n){return n!==undefined&&n.length>33&&(n=n.slice(0,19)+"..."+n.slice(-14)),n},text:{defaultResponseError:"Upload failure reason unknown",sizeSymbols:["kB","MB","GB","TB","PB","EB"]},deleteFile:{enabled:!1,method:"DELETE",endpoint:"/server/upload",customHeaders:{},params:{}},cors:{expected:!1,sendCredentials:!1,allowXdr:!1},blobs:{defaultName:"misc_data"},paste:{targetElement:null,defaultName:"pasted_image"},camera:{ios:!1,button:null},extraButtons:[],session:{endpoint:null,params:{},customHeaders:{},refreshOnReset:!0},form:{element:"qq-form",autoUpload:!1,interceptSubmit:!0},scaling:{sendOriginal:!0,orient:!0,defaultType:null,defaultQuality:80,failureText:"Failed to scale",includeExif:!1,sizes:[]}};qq.extend(this._options,n,!0);this._buttons=[];this._extraButtonSpecs={};this._buttonIdsForFileIds=[];this._wrapCallbacks();this._disposeSupport=new qq.DisposeSupport;this._storedIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._thumbnailUrls=[];this._netUploadedOrQueued=0;this._netUploaded=0;this._uploadData=this._createUploadDataTracker();this._initFormSupportAndParams();this._customHeadersStore=this._createStore(this._options.request.customHeaders);this._deleteFileCustomHeadersStore=this._createStore(this._options.deleteFile.customHeaders);this._deleteFileParamsStore=this._createStore(this._options.deleteFile.params);this._endpointStore=this._createStore(this._options.request.endpoint);this._deleteFileEndpointStore=this._createStore(this._options.deleteFile.endpoint);this._handler=this._createUploadHandler();this._deleteHandler=qq.DeleteFileAjaxRequester&&this._createDeleteHandler();this._options.button&&(this._defaultButtonId=this._createUploadButton({element:this._options.button}).getButtonId());this._generateExtraButtonSpecs();this._handleCameraAccess();this._options.paste.targetElement&&(qq.PasteSupport?this._pasteHandler=this._createPasteHandler():this.log("Paste support module not found","error"));this._preventLeaveInProgress();this._imageGenerator=qq.ImageGenerator&&new qq.ImageGenerator(qq.bind(this.log,this));this._refreshSessionData();this._succeededSinceLastAllComplete=[];this._failedSinceLastAllComplete=[];this._scaler=qq.Scaler&&new qq.Scaler(this._options.scaling,qq.bind(this.log,this))||{};this._scaler.enabled&&(this._customNewFileHandler=qq.bind(this._scaler.handleNewFile,this._scaler));qq.TotalProgress&&qq.supportedFeatures.progressBar&&(this._totalProgress=new qq.TotalProgress(qq.bind(this._onTotalProgress,this),function(n){var i=t._uploadData.retrieve({id:n});return i&&i.size||0}))};qq.FineUploaderBasic.prototype=qq.basePublicApi;qq.extend(qq.FineUploaderBasic.prototype,qq.basePrivateApi)}();qq.AjaxRequester=function(n){"use strict";function l(){return qq.indexOf(["GET","POST","HEAD"],t.method)>=0}function a(){var n=!1;return qq.each(n,function(t,i){if(qq.indexOf(["Accept","Accept-Language","Content-Language","Content-Type"],i)<0)return n=!0,!1}),n}function e(n){return t.cors.expected&&n.withCredentials===undefined}function v(){var n;return(window.XMLHttpRequest||window.ActiveXObject)&&(n=qq.createXhrInstance(),n.withCredentials===undefined&&(n=new XDomainRequest)),n}function u(n,r){var u=i[n].xhr;return u||(u=r?r:t.cors.expected?v():qq.createXhrInstance(),i[n].xhr=u),u}function h(n){var f=qq.indexOf(r,n),u=t.maxConnections,e;delete i[n];r.splice(f,1);r.length>=u&&f<u&&(e=r[u-1],c(e))}function s(n,i){var r=u(n),s=t.method,o=i===!0;h(n);o?f(s+" request for "+n+" has failed","error"):e(r)||nt(r.status)||(o=!0,f(s+" request for "+n+" has failed - response code "+r.status,"error"));t.onComplete(n,r,o)}function y(n){var u=i[n].additionalParams,f=t.mandatedParams,r;return t.paramsStore.get&&(r=t.paramsStore.get(n)),u&&qq.each(u,function(n,t){r=r||{};r[n]=t}),f&&qq.each(f,function(n,t){r=r||{};r[n]=t}),r}function c(n,r){var s=u(n,r),c=t.method,h=y(n),l=i[n].payload,a;t.onSend(n);return a=p(n,h),e(s)?(s.onload=k(n),s.onerror=d(n)):s.onreadystatechange=w(n),b(n),s.open(c,a,!0),t.cors.expected&&t.cors.sendCredentials&&!e(s)&&(s.withCredentials=!0),g(n),f("Sending "+c+" request for "+n),l?s.send(l):o||!h?s.send():h&&t.contentType&&t.contentType.toLowerCase().indexOf("application/x-www-form-urlencoded")>=0?s.send(qq.obj2url(h,"")):h&&t.contentType&&t.contentType.toLowerCase().indexOf("application/json")>=0?s.send(JSON.stringify(h)):s.send(h),s}function p(n,r){var u=t.endpointStore.get(n),f=i[n].addToPath;return f!=undefined&&(u+="/"+f),o&&r?qq.obj2url(r,u):u}function w(n){return function(){u(n).readyState===4&&s(n)}}function b(n){var i=t.onProgress;i&&(u(n).upload.onprogress=function(t){t.lengthComputable&&i(n,t.loaded,t.total)})}function k(n){return function(){s(n)}}function d(n){return function(){s(n,!0)}}function g(n){var r=u(n),f=t.customHeaders,h=i[n].additionalHeaders||{},s=t.method,o={};e(r)||(t.acceptHeader&&r.setRequestHeader("Accept",t.acceptHeader),t.allowXRequestedWithAndCacheControl&&(t.cors.expected&&l()&&!a(f)||(r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Cache-Control","no-cache"))),t.contentType&&(s==="POST"||s==="PUT")&&r.setRequestHeader("Content-Type",t.contentType),qq.extend(o,qq.isFunction(f)?f(n):f),qq.extend(o,h),qq.each(o,function(n,t){r.setRequestHeader(n,t)}))}function nt(n){return qq.indexOf(t.successfulResponseCodes[t.method],n)>=0}function tt(n,u,f,e,o,s){i[n]={addToPath:f,additionalParams:e,additionalHeaders:o,payload:s};var h=r.push(n);if(h<=t.maxConnections)return c(n,u)}var f,o,r=[],i={},t={acceptHeader:null,validMethods:["POST"],method:"POST",contentType:"application/x-www-form-urlencoded",maxConnections:3,customHeaders:{},endpointStore:{},paramsStore:{},mandatedParams:{},allowXRequestedWithAndCacheControl:!0,successfulResponseCodes:{DELETE:[200,202,204],POST:[200,204],GET:[200]},cors:{expected:!1,sendCredentials:!1},log:function(){},onSend:function(){},onComplete:function(){},onProgress:null};if(qq.extend(t,n),f=t.log,qq.indexOf(t.validMethods,t.method)<0)throw new Error("'"+t.method+"' is not a supported method for this type of request!");o=t.method==="GET"||t.method==="DELETE";qq.extend(this,{initTransport:function(n){var r,i,u,f,e;return{withPath:function(n){return r=n,this},withParams:function(n){return i=n,this},withHeaders:function(n){return u=n,this},withPayload:function(n){return f=n,this},withCacheBuster:function(){return e=!0,this},send:function(o){return e&&qq.indexOf(["GET","DELETE"],t.method)>=0&&(i.qqtimestamp=(new Date).getTime()),tt(n,o,r,i,u,f)}}},canceled:function(n){h(n)}})};qq.UploadHandler=function(n){"use strict";var i=n.proxy,t={},r=i.onCancel,u=i.getName;qq.extend(this,{add:function(n,i){t[n]=i;t[n].temp={}},cancel:function(n){var i=this,f=new qq.Promise,e=r(n,u(n),f);e.then(function(){i.isValid(n)&&(t[n].canceled=!0,i.expunge(n));f.success()})},expunge:function(n){delete t[n]},getThirdPartyFileId:function(n){return t[n].key},isValid:function(n){return t[n]!==undefined},reset:function(){t={}},_getFileState:function(n){return t[n]},_setThirdPartyFileId:function(n,i){t[n].key=i},_wasCanceled:function(n){return!!t[n].canceled}})};qq.UploadHandlerController=function(n,t){"use strict";var s=this,c=!1,h=!1,l,e,i,r={paramsStore:{},maxConnections:3,chunking:{enabled:!1,multiple:{enabled:!1}},log:function(){},onProgress:function(){},onComplete:function(){},onCancel:function(){},onUploadPrep:function(){},onUpload:function(){},onUploadChunk:function(){},onUploadChunkSuccess:function(){},onAutoRetry:function(){},onResume:function(){},onUuidChanged:function(){},getName:function(){},setSize:function(){},isQueued:function(){},getIdsInProxyGroup:function(){},getIdsInBatch:function(){}},o={done:function(n,t,u,f){var e=i._getChunkData(n,t);i._getFileState(n).attemptingResume=!1;delete i._getFileState(n).temp.chunkProgress[t];i._getFileState(n).loaded+=e.size;r.onUploadChunkSuccess(n,i._getChunkDataForCallback(e),u,f)},finalize:function(n){var t=r.getSize(n),u=r.getName(n);e("All chunks have been uploaded for "+n+" - finalizing....");i.finalizeChunks(n).then(function(o,s){e("Finalize successful for "+n);var h=f.normalizeResponse(o,!0);r.onProgress(n,u,t,t);i._maybeDeletePersistedChunkData(n);f.cleanup(n,h,s)},function(t,i){var s=f.normalizeResponse(t,!1);e("Problem finalizing chunks for file ID "+n+" - "+s.error,"error");s.reset&&o.reset(n);r.onAutoRetry(n,u,s,i)||f.cleanup(n,s,i)})},hasMoreParts:function(n){return!!i._getFileState(n).chunking.remaining.length},nextPart:function(n){var t=i._getFileState(n).chunking.remaining.shift();return t>=i._getTotalChunks(n)&&(t=null),t},reset:function(n){e("Server or callback has ordered chunking effort to be restarted on next attempt for item ID "+n,"error");i._maybeDeletePersistedChunkData(n);i.reevaluateChunking(n);i._getFileState(n).loaded=0},sendNext:function(n){var v=r.getSize(n),c=r.getName(n),t=o.nextPart(n),s=i._getChunkData(n,t),l=i._getFileState(n).attemptingResume,a=i._getFileState(n).chunking.inProgress||[];if(i._getFileState(n).loaded==null&&(i._getFileState(n).loaded=0),l&&r.onResume(n,c,s)===!1&&(o.reset(n),t=o.nextPart(n),s=i._getChunkData(n,t),l=!1),t==null&&a.length===0)o.finalize(n);else{e("Sending chunked upload request for item "+n+": bytes "+(s.start+1)+"-"+s.end+" of "+v);r.onUploadChunk(n,c,i._getChunkDataForCallback(s));a.push(t);i._getFileState(n).chunking.inProgress=a;h&&u.open(n,t);h&&u.available()&&i._getFileState(n).chunking.remaining.length&&o.sendNext(n);i.uploadChunk(n,t,l).then(function(r,u){e("Chunked upload request succeeded for "+n+", chunk "+t);i.clearCachedChunk(n,t);var s=i._getFileState(n).chunking.inProgress||[],c=f.normalizeResponse(r,!0),h=qq.indexOf(s,t);e(qq.format("Chunk {} for file {} uploaded successfully.",t,n));o.done(n,t,c,u);h>=0&&s.splice(h,1);i._maybePersistChunkedState(n);o.hasMoreParts(n)||s.length!==0?o.hasMoreParts(n)&&o.sendNext(n):o.finalize(n)},function(s,l){var a,v;e("Chunked upload request failed for "+n+", chunk "+t);i.clearCachedChunk(n,t);a=f.normalizeResponse(s,!1);a.reset?o.reset(n):(v=qq.indexOf(i._getFileState(n).chunking.inProgress,t),v>=0&&(i._getFileState(n).chunking.inProgress.splice(v,1),i._getFileState(n).chunking.remaining.unshift(t)));i._getFileState(n).temp.ignoreFailure||(h&&(i._getFileState(n).temp.ignoreFailure=!0,qq.each(i._getXhrs(n),function(n,t){t.abort()}),i.moveInProgressToRemaining(n),u.free(n,!0)),r.onAutoRetry(n,c,a,l)||f.cleanup(n,a,l))}).done(function(){i.clearXhr(n,t)})}}},u={_open:[],_openChunks:{},_waiting:[],available:function(){var i=r.maxConnections,n=0,t=0;return qq.each(u._openChunks,function(i,r){n++;t+=r.length}),i-(u._open.length-n+t)},free:function(n,t){var h=!t,o=qq.indexOf(u._waiting,n),s=qq.indexOf(u._open,n),r;delete u._openChunks[n];f.getProxyOrBlob(n)instanceof qq.BlobProxy&&(e("Generated blob upload has ended for "+n+", disposing generated blob."),delete i._getFileState(n).file);o>=0?u._waiting.splice(o,1):h&&s>=0&&(u._open.splice(s,1),r=u._waiting.shift(),r>=0&&(u._open.push(r),f.start(r)))},getWaitingOrConnected:function(){var n=[];return qq.each(n,u._open),qq.each(n,u._waiting)},isUsingConnection:function(n){return qq.indexOf(u._open,n)>=0},open:function(n,t){return(t==null&&u._waiting.push(n),u.available())?(t==null?(u._waiting.pop(),u._open.push(n)):function(){var i=u._openChunks[n]||[];i.push(t);u._openChunks[n]=i}(),!0):!1},reset:function(){u._waiting=[];u._open=[]}},a={send:function(n,t){i._getFileState(n).loaded=0;e("Sending simple upload request for "+n);i.uploadFile(n).then(function(i,u){e("Simple upload request succeeded for "+n);var o=f.normalizeResponse(i,!0),s=r.getSize(n);r.onProgress(n,t,s,s);f.maybeNewUuid(n,o);f.cleanup(n,o,u)},function(i,u){e("Simple upload request failed for "+n);var o=f.normalizeResponse(i,!1);r.onAutoRetry(n,t,o,u)||f.cleanup(n,o,u)})}},f={cancel:function(n){e("Cancelling "+n);r.paramsStore.remove(n);u.free(n)},cleanup:function(n,t,f){var e=r.getName(n);r.onComplete(n,e,t,f);i._getFileState(n)&&i._clearXhrs&&i._clearXhrs(n);u.free(n)},getProxyOrBlob:function(n){return i.getProxy&&i.getProxy(n)||i.getFile&&i.getFile(n)},initHandler:function(){var n=t?qq[t]:qq.traditional,u=qq.supportedFeatures.ajaxUploading?"Xhr":"Form";i=new n[u+"UploadHandler"](r,{getDataByUuid:r.getDataByUuid,getName:r.getName,getSize:r.getSize,getUuid:r.getUuid,log:e,onCancel:r.onCancel,onProgress:r.onProgress,onUuidChanged:r.onUuidChanged});i._removeExpiredChunkingRecords&&i._removeExpiredChunkingRecords()},isDeferredEligibleForUpload:function(n){return r.isQueued(n)},maybeDefer:function(n,t){if(t&&!i.getFile(n)&&t instanceof qq.BlobProxy){r.onUploadPrep(n);e("Attempting to generate a blob on-demand for "+n);t.create().then(function(t){e("Generated an on-demand blob for "+n);i.updateBlob(n,t);r.setSize(n,t.size);i.reevaluateChunking(n);f.maybeSendDeferredFiles(n)},function(t){var i={};t&&(i.error=t);e(qq.format("Failed to generate blob for ID {}.  Error message: {}.",n,t),"error");r.onComplete(n,r.getName(n),qq.extend(i,l),null);f.maybeSendDeferredFiles(n);u.free(n)})}else return f.maybeSendDeferredFiles(n);return!1},maybeSendDeferredFiles:function(n){var t=r.getIdsInProxyGroup(n),u=!1;return t&&t.length?(e("Maybe ready to upload proxy group file "+n),qq.each(t,function(t,r){if(f.isDeferredEligibleForUpload(r)&&!!i.getFile(r))u=r===n,f.now(r);else if(f.isDeferredEligibleForUpload(r))return!1})):(u=!0,f.now(n)),u},maybeNewUuid:function(n,t){if(t.newUuid!==undefined)r.onUuidChanged(n,t.newUuid)},normalizeResponse:function(n,t){var i=n;return qq.isObject(n)||(i={},qq.isString(n)&&!t&&(i.error=n)),i.success=t,i},now:function(n){var t=r.getName(n);if(!s.isValid(n))throw new qq.Error(n+" is not a valid file ID to upload!");r.onUpload(n,t);c&&i._shouldChunkThisFile(n)?o.sendNext(n):a.send(n,t)},start:function(n){var t=f.getProxyOrBlob(n);return t?f.maybeDefer(n,t):(f.now(n),!0)}};qq.extend(this,{add:function(){i.add.apply(this,arguments)},upload:function(n){return u.open(n)?f.start(n):!1},retry:function(n){return h&&(i._getFileState(n).temp.ignoreFailure=!1),u.isUsingConnection(n)?f.start(n):s.upload(n)},cancel:function(n){var t=i.cancel(n);qq.isGenericPromise(t)?t.then(function(){f.cancel(n)}):t!==!1&&f.cancel(n)},cancelAll:function(){var n=u.getWaitingOrConnected();qq.each(n,function(n,t){s.cancel(t)});u.reset()},getFile:function(n){return i.getProxy&&i.getProxy(n)?i.getProxy(n).referenceBlob:i.getFile&&i.getFile(n)},isProxied:function(n){return!!(i.getProxy&&i.getProxy(n))},getInput:function(n){if(i.getInput)return i.getInput(n)},reset:function(){e("Resetting upload handler");s.cancelAll();u.reset();i.reset()},expunge:function(n){if(s.isValid(n))return i.expunge(n)},isValid:function(n){return i.isValid(n)},getResumableFilesData:function(){return i.getResumableFilesData?i.getResumableFilesData():[]},getThirdPartyFileId:function(n){if(s.isValid(n))return i.getThirdPartyFileId(n)},pause:function(n){return s.isResumable(n)&&i.pause&&s.isValid(n)&&i.pause(n)?(u.free(n),i.moveInProgressToRemaining(n),!0):!1},isResumable:function(n){return!!i.isResumable&&i.isResumable(n)}});qq.extend(r,n);e=r.log;c=r.chunking.enabled&&qq.supportedFeatures.chunking;h=c&&r.chunking.concurrent.enabled;l=function(){var n={};return n[r.preventRetryParam]=!0,n}();f.initHandler()};qq.FormUploadHandler=function(n){"use strict";function y(n){delete r[n];h&&(clearTimeout(u[n]),delete u[n],e.stopReceivingMessages(n));var t=document.getElementById(i._getIframeName(n));t&&(t.setAttribute("src","javascript:false;"),qq(t).remove())}function c(n){return n.split("_")[0]}function p(n){var t=qq.toElement("<iframe src='javascript:false;' name='"+n+"' />");return t.setAttribute("id",n),t.style.display="none",document.body.appendChild(t),t}function w(n,o){var s=n.id,h=c(s),l=v(h);f[l]=o;r[h]=qq(n).attach("load",function(){i.getInput(h)&&(t("Received iframe load event for CORS upload request (iframe name "+s+")"),u[s]=setTimeout(function(){var n="No valid message received from loaded iframe for iframe name "+s;t(n,"error");o({error:n})},1e3))});e.receiveMessage(s,function(n){t("Received the following window message: '"+n+"'");var l=c(s),o=i._parseJsonResponse(l,n),r=o.uuid,h;r&&f[r]?(t("Handling response for iframe name "+s),clearTimeout(u[s]),delete u[s],i._detachLoadEvent(s),h=f[r],delete f[r],e.stopReceivingMessages(s),h(o)):r||t("'"+n+"' does not contain a UUID - ignoring.")})}var o=n.options,i=this,s=n.proxy,l=qq.getUniqueId(),f={},r={},u={},h=o.isCors,a=o.inputName,v=s.getUuid,t=s.log,e=new qq.WindowReceiveMessage({log:t});qq.extend(this,new qq.UploadHandler(n));qq.override(this,function(n){return{add:function(t,i){n.add(t,{input:i});i.setAttribute("name",a);i.parentNode&&qq(i).remove()},expunge:function(t){y(t);n.expunge(t)},isValid:function(t){return n.isValid(t)&&i._getFileState(t).input!==undefined}}});qq.extend(this,{_attachLoadEvent:function(n,i){var u;h?w(n,i):r[n.id]=qq(n).attach("load",function(){if(t("Received response for "+n.id),n.parentNode){try{if(n.contentDocument&&n.contentDocument.body&&n.contentDocument.body.innerHTML=="false")return}catch(r){t("Error when attempting to access iframe during handling of upload response ("+r.message+")","error");u={success:!1}}i(u)}})},_createIframe:function(n){var t=i._getIframeName(n);return p(t)},_detachLoadEvent:function(n){r[n]!==undefined&&(r[n](),delete r[n])},_getIframeName:function(n){return n+"_"+l},getInput:function(n){return i._getFileState(n).input},_initFormForUpload:function(n){var f=n.method,i=n.endpoint,r=n.params,e=n.paramsInBody,o=n.targetName,t=qq.toElement("<form method='"+f+"' enctype='multipart/form-data'><\/form>"),u=i;return e?qq.obj2Inputs(r,t):u=qq.obj2url(r,i),t.setAttribute("action",u),t.setAttribute("target",o),t.style.display="none",document.body.appendChild(t),t}})};qq.XhrUploadHandler=function(n){"use strict";function l(n){qq.each(t._getXhrs(n),function(i,r){var u=t._getAjaxRequester(n,i);r.onreadystatechange=null;r.upload.onprogress=null;r.abort();u&&u.canceled&&u.canceled(n)})}var t=this,h=n.options.namespace,i=n.proxy,r=n.options.chunking,c=n.options.resume,a=r&&n.options.chunking.enabled&&qq.supportedFeatures.chunking,f=c&&n.options.resume.enabled&&a&&qq.supportedFeatures.resume,e=i.getName,u=i.getSize,v=i.getUuid,y=i.getEndpoint,p=i.getDataByUuid,w=i.onUuidChanged,o=i.onProgress,s=i.log;qq.extend(this,new qq.UploadHandler(n));qq.override(this,function(n){return{add:function(i,r){if(qq.isFile(r)||qq.isBlob(r))n.add(i,{file:r});else if(r instanceof qq.BlobProxy)n.add(i,{proxy:r});else throw new Error("Passed obj is not a File, Blob, or proxy");t._initTempState(i);f&&t._maybePrepareForResume(i)},expunge:function(i){l(i);t._maybeDeletePersistedChunkData(i);t._clearXhrs(i);n.expunge(i)}}});qq.extend(this,{clearCachedChunk:function(n,i){delete t._getFileState(n).temp.cachedChunks[i]},clearXhr:function(n,i){var r=t._getFileState(n).temp;r.xhrs&&delete r.xhrs[i];r.ajaxRequesters&&delete r.ajaxRequesters[i]},finalizeChunks:function(n,i){var u=t._getTotalChunks(n)-1,r=t._getXhr(n,u);return i?(new qq.Promise).success(i(r),r):(new qq.Promise).success({},r)},getFile:function(n){return t.isValid(n)&&t._getFileState(n).file},getProxy:function(n){return t.isValid(n)&&t._getFileState(n).proxy},getResumableFilesData:function(){var n=[];return t._iterateResumeRecords(function(i,r){t.moveInProgressToRemaining(null,r.chunking.inProgress,r.chunking.remaining);var u={name:r.name,remaining:r.chunking.remaining,size:r.size,uuid:r.uuid};r.key&&(u.key=r.key);n.push(u)}),n},isResumable:function(n){return!!r&&t.isValid(n)&&!t._getFileState(n).notResumable},moveInProgressToRemaining:function(n,i,r){var u=i||t._getFileState(n).chunking.inProgress,f=r||t._getFileState(n).chunking.remaining;u&&(u.reverse(),qq.each(u,function(n,t){f.unshift(t)}),u.length=0)},pause:function(n){if(t.isValid(n))return s(qq.format("Aborting XHR upload for {} '{}' due to pause instruction.",n,e(n))),t._getFileState(n).paused=!0,l(n),!0},reevaluateChunking:function(n){var i,u,f;if(r&&t.isValid(n))if(i=t._getFileState(n),delete i.chunking,i.chunking={},u=t._getTotalChunks(n),u>1){for(i.chunking.enabled=!0,i.chunking.parts=u,i.chunking.remaining=[],f=0;f<u;f++)i.chunking.remaining.push(f);t._initTempState(n)}else i.chunking.enabled=!1},updateBlob:function(n,i){t.isValid(n)&&(t._getFileState(n).file=i)},_clearXhrs:function(n){var i=t._getFileState(n).temp;qq.each(i.ajaxRequesters,function(n){delete i.ajaxRequesters[n]});qq.each(i.xhrs,function(n){delete i.xhrs[n]})},_createXhr:function(n,i){return t._registerXhr(n,i,qq.createXhrInstance())},_getAjaxRequester:function(n,i){var r=i==null?-1:i;return t._getFileState(n).temp.ajaxRequesters[r]},_getChunkData:function(n,i){var e=r.partSize,s=u(n),l=t.getFile(n),f=e*i,o=f+e>=s?s:f+e,a=t._getTotalChunks(n),h=this._getFileState(n).temp.cachedChunks,c=h[i]||qq.sliceBlob(l,f,o);return h[i]=c,{part:i,start:f,end:o,count:a,blob:c,size:o-f}},_getChunkDataForCallback:function(n){return{partIndex:n.part,startByte:n.start+1,endByte:n.end,totalParts:n.count}},_getLocalStorageId:function(n){var t=e(n),i=u(n),f=r.partSize,o=y(n);return qq.format("qq{}resume{}-{}-{}-{}-{}",h,"5.0",t,i,f,o)},_getMimeType:function(n){return t.getFile(n).type},_getPersistableData:function(n){return t._getFileState(n).chunking},_getTotalChunks:function(n){if(r){var t=u(n),i=r.partSize;return Math.ceil(t/i)}},_getXhr:function(n,i){var r=i==null?-1:i;return t._getFileState(n).temp.xhrs[r]},_getXhrs:function(n){return t._getFileState(n).temp.xhrs},_iterateResumeRecords:function(n){f&&qq.each(localStorage,function(t,i){if(t.indexOf(qq.format("qq{}resume-",h))===0){var r=JSON.parse(i);n(t,r)}})},_initTempState:function(n){t._getFileState(n).temp={ajaxRequesters:{},chunkProgress:{},xhrs:{},cachedChunks:{}}},_markNotResumable:function(n){t._getFileState(n).notResumable=!0},_maybeDeletePersistedChunkData:function(n){var i;return f&&t.isResumable(n)&&(i=t._getLocalStorageId(n),i&&localStorage.getItem(i))?(localStorage.removeItem(i),!0):!1},_maybePrepareForResume:function(n){var r=t._getFileState(n),u,i;f&&r.key===undefined&&(u=t._getLocalStorageId(n),i=localStorage.getItem(u),i&&(i=JSON.parse(i),p(i.uuid)?t._markNotResumable(n):(s(qq.format("Identified file with ID {} and name of {} as resumable.",n,e(n))),w(n,i.uuid),r.key=i.key,r.chunking=i.chunking,r.loaded=i.loaded,r.attemptingResume=!0,t.moveInProgressToRemaining(n))))},_maybePersistChunkedState:function(n){var i=t._getFileState(n),r,o;f&&t.isResumable(n)&&(r=t._getLocalStorageId(n),o={name:e(n),size:u(n),uuid:v(n),key:i.key,chunking:i.chunking,loaded:i.loaded,lastUpdated:Date.now()},localStorage.setItem(r,JSON.stringify(o)))},_registerProgressHandler:function(n,i,r){var f=t._getXhr(n,i),e={simple:function(t,i){var r=u(n);t===i?o(n,name,r,r):o(n,name,t>=r?r-1:t,r)},chunked:function(f,e){var s=t._getFileState(n).temp.chunkProgress,c=t._getFileState(n).loaded,l=f,a=e,v=u(n),y=l-(a-r),h=c;s[i]=y;qq.each(s,function(n,t){h+=t});o(n,name,h,v)}};f.upload.onprogress=function(n){if(n.lengthComputable){var t=r==null?"simple":"chunked";e[t](n.loaded,n.total)}}},_registerXhr:function(n,i,r,u){var e=i==null?-1:i,f=t._getFileState(n).temp;return f.xhrs=f.xhrs||{},f.ajaxRequesters=f.ajaxRequesters||{},f.xhrs[e]=r,u&&(f.ajaxRequesters[e]=u),r},_removeExpiredChunkingRecords:function(){var n=c.recordsExpireIn;t._iterateResumeRecords(function(t,i){var r=new Date(i.lastUpdated);r.setDate(r.getDate()+n);r.getTime()<=Date.now()&&(s("Removing expired resume record with key "+t),localStorage.removeItem(t))})},_shouldChunkThisFile:function(n){var i=t._getFileState(n);return i.chunking||t.reevaluateChunking(n),i.chunking.enabled}})};qq.WindowReceiveMessage=function(n){"use strict";var i={log:function(){}},t={};qq.extend(i,n);qq.extend(this,{receiveMessage:function(n,i){var r=function(n){i(n.data)};window.postMessage?t[n]=qq(window).attach("message",r):log("iframe message passing not supported in this browser!","error")},stopReceivingMessages:function(n){if(window.postMessage){var i=t[n];i&&i()}}})},function(){"use strict";qq.uiPublicApi={clearStoredFiles:function(){this._parent.prototype.clearStoredFiles.apply(this,arguments);this._templating.clearFiles()},addExtraDropzone:function(n){this._dnd&&this._dnd.setupExtraDropzone(n)},removeExtraDropzone:function(n){if(this._dnd)return this._dnd.removeDropzone(n)},getItemByFileId:function(n){return this._templating.getFileContainer(n)},reset:function(){this._parent.prototype.reset.apply(this,arguments);this._templating.reset();!this._options.button&&this._templating.getButton()&&(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton()}).getButtonId());this._dnd&&(this._dnd.dispose(),this._dnd=this._setupDragAndDrop());this._totalFilesInBatch=0;this._filesInBatchAddedToUi=0;this._setupClickAndEditEventHandlers()},setName:function(n,t){var i=this._options.formatFileName(t);this._parent.prototype.setName.apply(this,arguments);this._templating.updateFilename(n,i)},pauseUpload:function(n){var t=this._parent.prototype.pauseUpload.apply(this,arguments);return t&&this._templating.uploadPaused(n),t},continueUpload:function(n){var t=this._parent.prototype.continueUpload.apply(this,arguments);return t&&this._templating.uploadContinued(n),t},getId:function(n){return this._templating.getFileId(n)},getDropTarget:function(n){var t=this.getFile(n);return t.qqDropTarget}};qq.uiPrivateApi={_getButton:function(n){var t=this._parent.prototype._getButton.apply(this,arguments);return t||n===this._defaultButtonId&&(t=this._templating.getButton()),t},_removeFileItem:function(n){this._templating.removeFile(n)},_setupClickAndEditEventHandlers:function(){this._fileButtonsClickHandler=qq.FileButtonsClickHandler&&this._bindFileButtonsClickEvent();this._focusinEventSupported=!qq.firefox();this._isEditFilenameEnabled()&&(this._filenameClickHandler=this._bindFilenameClickEvent(),this._filenameInputFocusInHandler=this._bindFilenameInputFocusInEvent(),this._filenameInputFocusHandler=this._bindFilenameInputFocusEvent())},_setupDragAndDrop:function(){var n=this,i=this._options.dragAndDrop.extraDropzones,t=this._templating,r=t.getDropZone();return r&&i.push(r),new qq.DragAndDrop({dropZoneElements:i,allowMultipleItems:this._options.multiple,classes:{dropActive:this._options.classes.dropActive},callbacks:{processingDroppedFiles:function(){t.showDropProcessing()},processingDroppedFilesComplete:function(i,r){t.hideDropProcessing();qq.each(i,function(n,t){t.qqDropTarget=r});i.length&&n.addFiles(i,null,null)},dropError:function(t,i){n._itemError(t,i)},dropLog:function(t,i){n.log(t,i)}}})},_bindFileButtonsClickEvent:function(){var n=this;return new qq.FileButtonsClickHandler({templating:this._templating,log:function(t,i){n.log(t,i)},onDeleteFile:function(t){n.deleteFile(t)},onCancel:function(t){n.cancel(t)},onRetry:function(t){qq(n._templating.getFileContainer(t)).removeClass(n._classes.retryable);n._templating.hideRetry(t);n.retry(t)},onPause:function(t){n.pauseUpload(t)},onContinue:function(t){n.continueUpload(t)},onGetName:function(t){return n.getName(t)}})},_isEditFilenameEnabled:function(){return this._templating.isEditFilenamePossible()&&!this._options.autoUpload&&qq.FilenameClickHandler&&qq.FilenameInputFocusHandler&&qq.FilenameInputFocusHandler},_filenameEditHandler:function(){var t=this,n=this._templating;return{templating:n,log:function(n,i){t.log(n,i)},onGetUploadStatus:function(n){return t.getUploads({id:n}).status},onGetName:function(n){return t.getName(n)},onSetName:function(n,i){t.setName(n,i)},onEditingStatusChange:function(t,i){var r=qq(n.getEditInput(t)),u=qq(n.getFileContainer(t));i?(r.addClass("qq-editing"),n.hideFilename(t),n.hideEditIcon(t)):(r.removeClass("qq-editing"),n.showFilename(t),n.showEditIcon(t));u.addClass("qq-temp").removeClass("qq-temp")}}},_onUploadStatusChange:function(n,t,i){this._parent.prototype._onUploadStatusChange.apply(this,arguments);this._isEditFilenameEnabled()&&this._templating.getFileContainer(n)&&i!==qq.status.SUBMITTED&&(this._templating.markFilenameEditable(n),this._templating.hideEditIcon(n))},_bindFilenameInputFocusInEvent:function(){var n=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusInHandler(n)},_bindFilenameInputFocusEvent:function(){var n=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusHandler(n)},_bindFilenameClickEvent:function(){var n=qq.extend({},this._filenameEditHandler());return new qq.FilenameClickHandler(n)},_storeForLater:function(n){this._parent.prototype._storeForLater.apply(this,arguments);this._templating.hideSpinner(n)},_onAllComplete:function(){this._parent.prototype._onAllComplete.apply(this,arguments);this._templating.resetTotalProgress()},_onSubmit:function(n,t){var i=this.getFile(n);i&&i.qqPath&&this._options.dragAndDrop.reportDirectoryPaths&&this._paramsStore.addReadOnly(n,{qqpath:i.qqPath});this._parent.prototype._onSubmit.apply(this,arguments);this._addToList(n,t)},_onSubmitted:function(n){this._isEditFilenameEnabled()&&(this._templating.markFilenameEditable(n),this._templating.showEditIcon(n),this._focusinEventSupported||this._filenameInputFocusHandler.addHandler(this._templating.getEditInput(n)))},_onProgress:function(n,t,i,r){this._parent.prototype._onProgress.apply(this,arguments);this._templating.updateProgress(n,i,r);Math.round(i/r*100)===100?(this._templating.hideCancel(n),this._templating.hidePause(n),this._templating.hideProgress(n),this._templating.setStatusText(n,this._options.text.waitingForResponse),this._displayFileSize(n)):this._displayFileSize(n,i,r)},_onTotalProgress:function(n,t){this._parent.prototype._onTotalProgress.apply(this,arguments);this._templating.updateTotalProgress(n,t)},_onComplete:function(n,t,i){function o(t){f&&(r.setStatusText(n),qq(f).removeClass(u._classes.retrying),r.hideProgress(n),(!u._options.disableCancelForFormUploads||qq.supportedFeatures.ajaxUploading)&&r.hideCancel(n),r.hideSpinner(n),t.success?u._markFileAsSuccessful(n):(qq(f).addClass(u._classes.fail),r.isRetryPossible()&&!u._preventRetries[n]&&(qq(f).addClass(u._classes.retryable),r.showRetry(n)),u._controlFailureTextDisplay(n,t)))}var e=this._parent.prototype._onComplete.apply(this,arguments),r=this._templating,f=r.getFileContainer(n),u=this;return e instanceof qq.Promise?e.done(function(n){o(n)}):o(i),e},_markFileAsSuccessful:function(n){var t=this._templating;this._isDeletePossible()&&t.showDeleteButton(n);qq(t.getFileContainer(n)).addClass(this._classes.success);this._maybeUpdateThumbnail(n)},_onUploadPrep:function(n){this._parent.prototype._onUploadPrep.apply(this,arguments);this._templating.showSpinner(n)},_onUpload:function(n){var t=this._parent.prototype._onUpload.apply(this,arguments);return this._templating.showSpinner(n),t},_onUploadChunk:function(n,t){this._parent.prototype._onUploadChunk.apply(this,arguments);t.partIndex>0&&this._handler.isResumable(n)&&this._templating.allowPause(n)},_onCancel:function(n){this._parent.prototype._onCancel.apply(this,arguments);this._removeFileItem(n);this._getNotFinished()===0&&this._templating.resetTotalProgress()},_onBeforeAutoRetry:function(n){var i,r,t;this._parent.prototype._onBeforeAutoRetry.apply(this,arguments);this._showCancelLink(n);this._options.retry.showAutoRetryNote&&(i=this._autoRetries[n],r=this._options.retry.maxAutoAttempts,t=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,i),t=t.replace(/\{maxAuto\}/g,r),this._templating.setStatusText(n,t),qq(this._templating.getFileContainer(n)).addClass(this._classes.retrying))},_onBeforeManualRetry:function(n){return this._parent.prototype._onBeforeManualRetry.apply(this,arguments)?(this._templating.resetProgress(n),qq(this._templating.getFileContainer(n)).removeClass(this._classes.fail),this._templating.setStatusText(n),this._templating.showSpinner(n),this._showCancelLink(n),!0):(qq(this._templating.getFileContainer(n)).addClass(this._classes.retryable),this._templating.showRetry(n),!1)},_onSubmitDelete:function(n){var t=qq.bind(this._onSubmitDeleteSuccess,this);this._parent.prototype._onSubmitDelete.call(this,n,t)},_onSubmitDeleteSuccess:function(){this._options.deleteFile.forceConfirm?this._showDeleteConfirm.apply(this,arguments):this._sendDeleteRequest.apply(this,arguments)},_onDeleteComplete:function(n,t,i){this._parent.prototype._onDeleteComplete.apply(this,arguments);this._templating.hideSpinner(n);i?(this._templating.setStatusText(n,this._options.deleteFile.deletingFailedText),this._templating.showDeleteButton(n)):this._removeFileItem(n)},_sendDeleteRequest:function(n){this._templating.hideDeleteButton(n);this._templating.showSpinner(n);this._templating.setStatusText(n,this._options.deleteFile.deletingStatusText);this._deleteHandler.sendDelete.apply(this,arguments)},_showDeleteConfirm:function(n){var u=this.getName(n),f=this._options.deleteFile.confirmMessage.replace(/\{filename\}/g,u),uuid=this.getUuid(n),r=arguments,t=this,i;i=this._options.showConfirm(f);qq.isGenericPromise(i)?i.then(function(){t._sendDeleteRequest.apply(t,r)}):i!==!1&&t._sendDeleteRequest.apply(t,r)},_addToList:function(n,t,i){var r,u=0,f=this._handler.isProxied(n)&&this._options.scaling.hideScaled;f||(this._options.display.prependFiles&&(this._totalFilesInBatch>1&&this._filesInBatchAddedToUi>0&&(u=this._filesInBatchAddedToUi-1),r={index:u}),i||(this._options.disableCancelForFormUploads&&!qq.supportedFeatures.ajaxUploading&&this._templating.disableCancel(),this._options.multiple||(this._handler.cancelAll(),this._clearList())),this._templating.addFile(n,this._options.formatFileName(t),r),i?this._thumbnailUrls[n]&&this._templating.updateThumbnail(n,this._thumbnailUrls[n],!0):this._templating.generatePreview(n,this.getFile(n)),this._filesInBatchAddedToUi+=1,(i||this._options.display.fileSizeOnSubmit&&qq.supportedFeatures.ajaxUploading)&&this._displayFileSize(n))},_clearList:function(){this._templating.clearFiles();this.clearStoredFiles()},_displayFileSize:function(n,t,i){var r=this.getSize(n),u=this._formatSize(r);r>=0&&(t!==undefined&&i!==undefined&&(u=this._formatProgress(t,i)),this._templating.updateSize(n,u))},_formatProgress:function(n,t){function r(n,t){i=i.replace(n,t)}var i=this._options.text.formatProgress;return r("{percent}",Math.round(n/t*100)),r("{total_size}",this._formatSize(t)),i},_controlFailureTextDisplay:function(n,t){var r,u,f,i,e;r=this._options.failedUploadTextDisplay.mode;u=this._options.failedUploadTextDisplay.maxChars;f=this._options.failedUploadTextDisplay.responseProperty;r==="custom"?(i=t[f],i?i.length>u&&(e=i.substring(0,u)+"..."):i=this._options.text.failUpload,this._templating.setStatusText(n,e||i),this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(n,i)):r==="default"?this._templating.setStatusText(n,this._options.text.failUpload):r!=="none"&&this.log("failedUploadTextDisplay.mode value of '"+r+"' is not valid","warn")},_showTooltip:function(n,t){this._templating.getFileContainer(n).title=t},_showCancelLink:function(n){(!this._options.disableCancelForFormUploads||qq.supportedFeatures.ajaxUploading)&&this._templating.showCancel(n)},_itemError:function(){var n=this._parent.prototype._itemError.apply(this,arguments);this._options.showMessage(n)},_batchError:function(n){this._parent.prototype._batchError.apply(this,arguments);this._options.showMessage(n)},_setupPastePrompt:function(){var n=this;this._options.callbacks.onPasteReceived=function(){var t=n._options.paste.namePromptMessage,i=n._options.paste.defaultName;return n._options.showPrompt(t,i)}},_fileOrBlobRejected:function(){this._totalFilesInBatch-=1;this._parent.prototype._fileOrBlobRejected.apply(this,arguments)},_prepareItemsForUpload:function(n){this._totalFilesInBatch=n.length;this._filesInBatchAddedToUi=0;this._parent.prototype._prepareItemsForUpload.apply(this,arguments)},_maybeUpdateThumbnail:function(n){var t=this._thumbnailUrls[n];this._templating.updateThumbnail(n,t)},_addCannedFile:function(){var n=this._parent.prototype._addCannedFile.apply(this,arguments);return this._addToList(n,this.getName(n),!0),this._templating.hideSpinner(n),this._templating.hideCancel(n),this._markFileAsSuccessful(n),n},_setSize:function(n,t){this._parent.prototype._setSize.apply(this,arguments);this._templating.updateSize(n,this._formatSize(t))}}}();qq.FineUploader=function(n,t){"use strict";this._parent=t?qq[t].FineUploaderBasic:qq.FineUploaderBasic;this._parent.apply(this,arguments);qq.extend(this._options,{element:null,button:null,listElement:null,dragAndDrop:{extraDropzones:[],reportDirectoryPaths:!1},text:{formatProgress:"{percent}% of {total_size}",failUpload:"Upload failed",waitingForResponse:"Processing...",paused:"Paused"},template:"qq-template",classes:{retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",success:"qq-upload-success",fail:"qq-upload-fail",editable:"qq-editable",hide:"qq-hide",dropActive:"qq-upload-drop-area-active"},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:!0},messages:{tooManyFilesError:"You may only drop one file",unsupportedBrowser:"Unrecoverable error - this browser does not permit file uploading of any kind."},retry:{showAutoRetryNote:!0,autoRetryNote:"Retrying {retryNum}/{maxAuto}..."},deleteFile:{forceConfirm:!1,confirmMessage:"Are you sure you want to delete {filename}?",deletingStatusText:"Deleting...",deletingFailedText:"Delete failed"},display:{fileSizeOnSubmit:!1,prependFiles:!1},paste:{promptForName:!1,namePromptMessage:"Please name this image"},thumbnails:{placeholders:{waitUntilResponse:!1,notAvailablePath:null,waitingPath:null}},scaling:{hideScaled:!1},showMessage:function(n){setTimeout(function(){window.alert(n)},0)},showConfirm:function(n){return window.confirm(n)},showPrompt:function(n,t){return window.prompt(n,t)}},!0);qq.extend(this._options,n,!0);this._templating=new qq.Templating({log:qq.bind(this.log,this),templateIdOrEl:this._options.template,containerEl:this._options.element,fileContainerEl:this._options.listElement,button:this._options.button,imageGenerator:this._imageGenerator,classes:{hide:this._options.classes.hide,editable:this._options.classes.editable},placeholders:{waitUntilUpdate:this._options.thumbnails.placeholders.waitUntilResponse,thumbnailNotAvailable:this._options.thumbnails.placeholders.notAvailablePath,waitingForThumbnail:this._options.thumbnails.placeholders.waitingPath},text:this._options.text});qq.supportedFeatures.uploading&&(!this._options.cors.expected||qq.supportedFeatures.uploadCors)?(this._wrapCallbacks(),this._templating.render(),this._classes=this._options.classes,!this._options.button&&this._templating.getButton()&&(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton()}).getButtonId()),this._setupClickAndEditEventHandlers(),qq.DragAndDrop&&qq.supportedFeatures.fileDrop&&(this._dnd=this._setupDragAndDrop()),this._options.paste.targetElement&&this._options.paste.promptForName&&(qq.PasteSupport?this._setupPastePrompt():this.log("Paste support module not found.","error")),this._totalFilesInBatch=0,this._filesInBatchAddedToUi=0):this._templating.renderFailure(this._options.messages.unsupportedBrowser)};qq.extend(qq.FineUploader.prototype,qq.basePublicApi);qq.extend(qq.FineUploader.prototype,qq.basePrivateApi);qq.extend(qq.FineUploader.prototype,qq.uiPublicApi);qq.extend(qq.FineUploader.prototype,qq.uiPrivateApi);qq.Templating=function(n){"use strict";function gt(){var s,f,e,n,v,c,u,r,l;if(o("Parsing template"),i.templateIdOrEl==null)throw new Error("You MUST specify either a template element or ID!");if(qq.isString(i.templateIdOrEl)){if(s=document.getElementById(i.templateIdOrEl),s===null)throw new Error(qq.format("Cannot find template script at ID '{}'!",i.templateIdOrEl));f=s.innerHTML}else{if(i.templateIdOrEl.innerHTML===undefined)throw new Error("You have specified an invalid value for the template option!  It must be an ID or an Element.");f=i.templateIdOrEl.innerHTML}if(f=qq.trimStr(f),n=document.createElement("div"),n.appendChild(qq.toElement(f)),i.button&&(c=qq(n).getByClass(t.button)[0],c&&qq(c).remove()),qq.DragAndDrop&&qq.supportedFeatures.fileDrop||(l=qq(n).getByClass(t.dropProcessing)[0],l&&qq(l).remove()),u=qq(n).getByClass(t.drop)[0],u&&!qq.DragAndDrop&&(o("DnD module unavailable.","info"),qq(u).remove()),u&&!qq.supportedFeatures.fileDrop&&qq(u).hasAttribute(dt)&&qq(u).css({display:"none"}),r=qq(n).getByClass(t.thumbnail)[0],a?r&&(h=parseInt(r.getAttribute(bt)),h=h>0?h:null,rt=qq(r).hasAttribute(kt)):r&&qq(r).remove(),a=a&&r,ct=qq(n).getByClass(t.editFilenameInput).length>0,lt=qq(n).getByClass(t.retry).length>0,e=qq(n).getByClass(t.list)[0],e==null)throw new Error("Could not find the file list container in the template!");return v=e.innerHTML,e.innerHTML="",o("Template parsing complete"),{template:qq.trimStr(n.innerHTML),fileTemplate:qq.trimStr(v)}}function f(n){return qq(l).getByClass(ht+n)[0]}function r(n,t){return n&&qq(n).getByClass(t)[0]}function ni(n,t){var i=l,r=i.firstChild;t>0&&(r=qq(i).children()[t].nextSibling);i.insertBefore(n,r)}function at(n){return r(f(n),t.cancel)}function w(n){return r(f(n),t.pause)}function ut(n){return r(f(n),t.continueButton)}function b(n){return n==null?r(s,t.totalProgressBarContainer)||r(s,t.totalProgressBar):r(f(n),t.progressBarContainer)||r(f(n),t.progressBar)}function k(n){return r(f(n),t.spinner)}function vt(n){return r(f(n),t.editNameIcon)}function yt(n){return r(f(n),t.size)}function ft(n){return r(f(n),t.deleteButton)}function et(n){return r(f(n),t.retry)}function d(n){return r(f(n),t.file)}function ot(){return r(s,t.dropProcessing)}function v(n){return a&&r(f(n),t.thumbnail)}function u(n){n&&qq(n).addClass(i.classes.hide)}function e(n){n&&qq(n).removeClass(i.classes.hide)}function pt(n,i){var r=b(n),u=n==null?t.totalProgressBar:t.progressBar;r&&!qq(r).hasClass(u)&&(r=qq(r).getByClass(u)[0]);r&&qq(r).css({width:i+"%"})}function ti(){var n=i.placeholders.thumbnailNotAvailable,t=i.placeholders.waitingForThumbnail,r={maxSize:h,scale:rt};a&&(n?i.imageGenerator.generate(n,new Image,r).then(function(n){y.success(n)},function(){y.failure();o("Problem loading 'not available' placeholder image at "+n,"error")}):y.failure(),t?i.imageGenerator.generate(t,new Image,r).then(function(n){p.success(n)},function(){p.failure();o("Problem loading 'waiting for thumbnail' placeholder image at "+t,"error")}):p.failure())}function st(n){var t=new qq.Promise;return p.then(function(i){wt(i,n);n.src?t.success():(n.src=i.src,n.onload=function(){e(n);t.success()})},function(){u(n);t.success()}),t}function g(n,t){var r=c[n]||(new qq.Promise).failure(),i=new qq.Promise;return y.then(function(n){r.then(function(){i.success()},function(){wt(n,t);t.onload=function(){i.success()};t.src=n.src;e(t)})}),i}function wt(n,t){var i=n.style.maxWidth,r=n.style.maxHeight;r&&i&&!t.style.maxWidth&&!t.style.maxHeight&&qq(t).css({maxWidth:i,maxHeight:r})}function ii(n,t){var r=v(n),u=v(t);o(qq.format("ID {} is the same file as ID {}.  Will use generated thumbnail from ID {} instead.",n,t,t));c[t].then(function(){c[n].success();o(qq.format("Now using previously generated thumbnail created for ID {} on ID {}.",t,n));r.src=u.src;e(r)},function(){c[n].failure();i.placeholders.waitUntilUpdate||g(n,r)})}function ri(n,t,r){var u=v(n);return o("Generating new thumbnail for "+n),t.qqThumbnailId=n,i.imageGenerator.generate(t,u,r).then(function(){e(u);c[n].success()},function(){c[n].failure();i.placeholders.waitUntilUpdate||g(n,u)})}var nt="qq-file-id",ht="qq-file-id-",bt="qq-max-size",kt="qq-server-scale",dt="qq-hide-dropzone",tt=!1,h=-1,i={log:null,templateIdOrEl:"qq-template",containerEl:null,fileContainerEl:null,button:null,imageGenerator:null,classes:{hide:"qq-hide",editable:"qq-editable"},placeholders:{waitUntilUpdate:!1,thumbnailNotAvailable:null,waitingForThumbnail:null},text:{paused:"Paused"}},t={button:"qq-upload-button-selector",drop:"qq-upload-drop-area-selector",list:"qq-upload-list-selector",progressBarContainer:"qq-progress-bar-container-selector",progressBar:"qq-progress-bar-selector",totalProgressBarContainer:"qq-total-progress-bar-container-selector",totalProgressBar:"qq-total-progress-bar-selector",file:"qq-upload-file-selector",spinner:"qq-upload-spinner-selector",size:"qq-upload-size-selector",cancel:"qq-upload-cancel-selector",pause:"qq-upload-pause-selector",continueButton:"qq-upload-continue-selector",deleteButton:"qq-upload-delete-selector",retry:"qq-upload-retry-selector",statusText:"qq-upload-status-text-selector",editFilenameInput:"qq-edit-filename-selector",editNameIcon:"qq-edit-filename-icon-selector",dropProcessing:"qq-drop-processing-selector",dropProcessingSpinner:"qq-drop-processing-spinner-selector",thumbnail:"qq-thumbnail-selector"},c={},y=new qq.Promise,p=new qq.Promise,o,ct,lt,it,s,l,a,rt;qq.extend(i,n);o=i.log;s=i.containerEl;a=i.imageGenerator!==undefined;it=gt();ti();qq.extend(this,{render:function(){o("Rendering template in DOM.");s.innerHTML=it.template;u(ot());this.hideTotalProgress();l=i.fileContainerEl||r(s,t.list);o("Template rendering complete")},renderFailure:function(n){var t=qq.toElement(n);s.innerHTML="";s.appendChild(t)},reset:function(){this.render()},clearFiles:function(){l.innerHTML=""},disableCancel:function(){tt=!0},addFile:function(n,i,f){var e=qq.toElement(it.fileTemplate),o=r(e,t.file);qq(e).addClass(ht+n);o&&qq(o).setText(i);e.setAttribute(nt,n);f?ni(e,f.index):l.appendChild(e);u(b(n));u(yt(n));u(ft(n));u(et(n));u(w(n));u(ut(n));tt&&this.hideCancel(n)},removeFile:function(n){qq(f(n)).remove()},getFileId:function(n){var t=n;if(t){while(t.getAttribute(nt)==null)t=t.parentNode;return parseInt(t.getAttribute(nt))}},getFileList:function(){return l},markFilenameEditable:function(n){var t=d(n);t&&qq(t).addClass(i.classes.editable)},updateFilename:function(n,t){var i=d(n);i&&qq(i).setText(t)},hideFilename:function(n){u(d(n))},showFilename:function(n){e(d(n))},isFileName:function(n){return qq(n).hasClass(t.file)},getButton:function(){return i.button||r(s,t.button)},hideDropProcessing:function(){u(ot())},showDropProcessing:function(){e(ot())},getDropZone:function(){return r(s,t.drop)},isEditFilenamePossible:function(){return ct},hideRetry:function(n){u(et(n))},isRetryPossible:function(){return lt},showRetry:function(n){e(et(n))},getFileContainer:function(n){return f(n)},showEditIcon:function(n){var t=vt(n);t&&qq(t).addClass(i.classes.editable)},hideEditIcon:function(n){var t=vt(n);t&&qq(t).removeClass(i.classes.editable)},isEditIcon:function(n){return qq(n).hasClass(t.editNameIcon)},getEditInput:function(n){return r(f(n),t.editFilenameInput)},isEditInput:function(n){return qq(n).hasClass(t.editFilenameInput)},updateProgress:function(n,t,i){var r=b(n),f;r&&(f=Math.round(t/i*100),f===100?u(r):e(r),pt(n,f))},updateTotalProgress:function(n,t){this.updateProgress(null,n,t)},hideProgress:function(n){var t=b(n);t&&u(t)},hideTotalProgress:function(){this.hideProgress()},resetProgress:function(n){pt(n,0)},resetTotalProgress:function(){this.resetProgress()},showCancel:function(n){if(!tt){var t=at(n);t&&qq(t).removeClass(i.classes.hide)}},hideCancel:function(n){u(at(n))},isCancel:function(n){return qq(n).hasClass(t.cancel)},allowPause:function(n){e(w(n));u(ut(n))},uploadPaused:function(n){this.setStatusText(n,i.text.paused);this.allowContinueButton(n);u(k(n))},hidePause:function(n){u(w(n))},isPause:function(n){return qq(n).hasClass(t.pause)},isContinueButton:function(n){return qq(n).hasClass(t.continueButton)},allowContinueButton:function(n){e(ut(n));u(w(n))},uploadContinued:function(n){this.setStatusText(n,"");this.allowPause(n);e(k(n))},showDeleteButton:function(n){e(ft(n))},hideDeleteButton:function(n){u(ft(n))},isDeleteButton:function(n){return qq(n).hasClass(t.deleteButton)},isRetry:function(n){return qq(n).hasClass(t.retry)},updateSize:function(n,t){var i=yt(n);i&&(e(i),qq(i).setText(t))},setStatusText:function(n,i){var u=r(f(n),t.statusText);u&&(i==null?qq(u).clearText():qq(u).setText(i))},hideSpinner:function(n){u(k(n))},showSpinner:function(n){e(k(n))},generatePreview:function(n,t){var r=t&&t.qqThumbnailId,i=v(n),u={maxSize:h,scale:!0,orient:!0};qq.supportedFeatures.imagePreviews?i&&st(i).done(function(){c[n]=new qq.Promise;r!=null?ii(n,r):ri(n,t,u)}):i&&st(i)},updateThumbnail:function(n,t,r){var u=v(n),f={maxSize:h,scale:rt};if(u){if(t)return r&&st(u),i.imageGenerator.generate(t,u,f).then(function(){e(u)},function(){g(n,u)});g(n,u)}}})};qq.traditional=qq.traditional||{};qq.traditional.FormUploadHandler=function(n,t){"use strict";function e(n){var t={};try{t=qq.parseJson(n)}catch(r){i("Error when attempting to parse iframe upload response ("+r.message+")","error")}return t}function o(n,t){var u,f,r;try{f=t.contentDocument||t.contentWindow.document;r=f.body.innerHTML;i("converting iframe's innerHTML to JSON");i("innerHTML = "+r);r&&r.match(/^<pre/i)&&(r=f.body.firstChild.firstChild.nodeValue);u=e(r)}catch(o){i("Error when attempting to parse form upload response ("+o.message+")","error");u={success:!1}}return u}function s(t,i){var e=n.paramsStore.get(t),o=n.demoMode?"GET":"POST",s=n.endpointStore.get(t),h=u(t);return e[n.uuidName]=f(t),e[n.filenameParam]=h,r._initFormForUpload({method:o,endpoint:s,params:e,paramsInBody:n.paramsInBody,targetName:i.name})}var r=this,u=t.getName,f=t.getUuid,i=t.log;this.uploadFile=function(t){var h=r.getInput(t),u=r._createIframe(t),e=new qq.Promise,f;return f=s(t,u),f.appendChild(h),r._attachLoadEvent(u,function(f){i("iframe loaded");var s=f?f:o(t,u);r._detachLoadEvent(t);n.cors.expected||qq(u).remove();s.success?e.success(s):e.failure(s)}),i("Sending upload request for "+t),f.submit(),qq(f).remove(),e};qq.extend(this,new qq.FormUploadHandler({options:{isCors:n.cors.expected,inputName:n.inputName},proxy:{onCancel:n.onCancel,getName:u,getUuid:f,log:i}}))};qq.traditional=qq.traditional||{};qq.traditional.XhrUploadHandler=function(n,t){"use strict";var i=this,o=t.getName,f=t.getSize,s=t.getUuid,r=t.log,u=n.forceMultipart||n.paramsInBody,a=function(t,i,r){var e=f(t),s=o(t);i[n.chunking.paramNames.partIndex]=r.part;i[n.chunking.paramNames.partByteOffset]=r.start;i[n.chunking.paramNames.chunkSize]=r.size;i[n.chunking.paramNames.totalParts]=r.count;i[n.totalFileSizeName]=e;u&&(i[n.filenameParam]=s)},v=new qq.traditional.AllChunksDoneAjaxRequester({cors:n.cors,endpoint:n.chunking.success.endpoint,log:r}),h=function(n,t){var i=new qq.Promise;return t.onreadystatechange=function(){if(t.readyState===4){var r=w(n,t);r.success?i.success(r.response,t):i.failure(r.response,t)}},i},y=function(t){var r=n.paramsStore.get(t),u=o(t),e=f(t);return r[n.uuidName]=s(t),r[n.filenameParam]=u,r[n.totalFileSizeName]=e,r[n.chunking.paramNames.totalParts]=i._getTotalChunks(t),r},p=function(n,t){return n.status!==200||!t.success||t.reset},w=function(n,t){var i;return r("xhr - server response received for "+n),r("responseText = "+t.responseText),i=e(!0,t),{success:!p(t,i),response:i}},e=function(n,t){var i={};try{r(qq.format("Received response status {} with body: {}",t.status,t.responseText));i=qq.parseJson(t.responseText)}catch(u){n&&r("Error when attempting to parse xhr response text ("+u.message+")","error")}return i},b=function(t){var r=new qq.Promise;return v.complete(t,i._createXhr(t),y(t),n.customHeaders.get(t)).then(function(n){r.success(e(!1,n),n)},function(n){r.failure(e(!1,n),n)}),r},c=function(t,i,r,e){var h=new FormData,a=n.demoMode?"GET":"POST",c=n.endpointStore.get(e),l=o(e),v=f(e);return(t[n.uuidName]=s(e),t[n.filenameParam]=l,u&&(t[n.totalFileSizeName]=v),n.paramsInBody||(u||(t[n.inputName]=l),c=qq.obj2url(t,c)),i.open(a,c,!0),n.cors.expected&&n.cors.sendCredentials&&(i.withCredentials=!0),u)?(n.paramsInBody&&qq.obj2FormData(t,h),h.append(n.inputName,r),h):r},l=function(t,r){var f=n.customHeaders.get(t),e=i.getFile(t);r.setRequestHeader("Accept","application/json");r.setRequestHeader("X-Requested-With","XMLHttpRequest");r.setRequestHeader("Cache-Control","no-cache");u||(r.setRequestHeader("Content-Type","application/octet-stream"),r.setRequestHeader("X-Mime-Type",e.type));qq.each(f,function(n,t){r.setRequestHeader(n,t)})};qq.extend(this,{uploadChunk:function(t,r,u){var s=i._getChunkData(t,r),e=i._createXhr(t,r),p=f(t),v,y,o;return v=h(t,e),i._registerProgressHandler(t,r,s.size),o=n.paramsStore.get(t),a(t,o,s),u&&(o[n.resume.paramNames.resuming]=!0),y=c(o,e,s.blob,t),l(t,e),e.send(y),v},uploadFile:function(t){var o=i.getFile(t),u,r,f,e;return r=i._createXhr(t),i._registerProgressHandler(t),u=h(t,r),f=n.paramsStore.get(t),e=c(f,r,o,t),l(t,r),r.send(e),u}});qq.extend(this,new qq.XhrUploadHandler({options:qq.extend({namespace:"traditional"},n),proxy:qq.extend({getEndpoint:n.endpointStore.get},t)}));qq.override(this,function(t){return{finalizeChunks:function(i){return n.chunking.success.endpoint?b(i):t.finalizeChunks(i,qq.bind(e,this,!0))}}})};qq.traditional.AllChunksDoneAjaxRequester=function(n){"use strict";var u,i="POST",t={cors:{allowXdr:!1,expected:!1,sendCredentials:!1},endpoint:null,log:function(){}},r={},f={get:function(){return t.endpoint}};qq.extend(t,n);u=qq.extend(this,new qq.AjaxRequester({acceptHeader:"application/json",validMethods:[i],method:i,successfulResponseCodes:function(){var n={};return n[i]=[200,201,202],n}(),endpointStore:f,allowXRequestedWithAndCacheControl:!1,cors:t.cors,log:t.log,onComplete:function(n,t,i){var u=r[n];delete r[n];i?u.failure(t):u.success(t)}}));qq.extend(this,{complete:function(n,i,f,e){var o=new qq.Promise;return t.log("Submitting All Chunks Done request for "+n),r[n]=o,u.initTransport(n).withParams(f).withHeaders(e).send(i),o}})};qq.PasteSupport=function(n){"use strict";function r(n){return n.type&&n.type.indexOf("image/")===0}function u(){qq(t.targetElement).attach("paste",function(n){var i=n.clipboardData;i&&qq.each(i.items,function(n,i){if(r(i)){var u=i.getAsFile();t.callbacks.pasteReceived(u)}})})}function f(){i&&i()}var t,i;t={targetElement:null,callbacks:{log:function(){},pasteReceived:function(){}}};qq.extend(t,n);u();qq.extend(this,{reset:function(){f()}})};qq.DragAndDrop=function(n){"use strict";function c(n,i){var r=Array.prototype.slice.call(n);t.callbacks.dropLog("Grabbed "+n.length+" dropped files.");i.dropDisabled(!1);t.callbacks.processingDroppedFilesComplete(r,i.getElement())}function o(n){var i=new qq.Promise;return n.isFile?n.file(function(t){var f=n.name,u=n.fullPath,e=u.indexOf(f);u=u.substr(0,e);u.charAt(0)==="/"&&(u=u.substr(1));t.qqPath=u;r.push(t);i.success()},function(r){t.callbacks.dropLog("Problem parsing '"+n.fullPath+"'.  FileError code "+r.code+".","error");i.failure()}):n.isDirectory&&s(n).then(function(n){var t=n.length;qq.each(n,function(n,r){o(r).done(function(){t-=1;t===0&&i.success()})});n.length||i.success()},function(r){t.callbacks.dropLog("Problem parsing '"+n.fullPath+"'.  FileError code "+r.code+".","error");i.failure()}),i}function s(n,t,i,r){var u=r||new qq.Promise,f=t||n.createReader();return f.readEntries(function(t){var r=i?i.concat(t):t;t.length?setTimeout(function(){s(n,f,r,u)},0):u.success(r)},u.failure),u}function l(n,i){var u=[],f=new qq.Promise;return t.callbacks.processingDroppedFiles(),i.dropDisabled(!0),n.files.length>1&&!t.allowMultipleItems?(t.callbacks.processingDroppedFilesComplete([]),t.callbacks.dropError("tooManyFilesError",""),i.dropDisabled(!1),f.failure()):(r=[],qq.isFolderDropSupported(n)?qq.each(n.items,function(n,t){var i=t.webkitGetAsEntry();i&&(i.isFile?r.push(t.getAsFile()):u.push(o(i).done(function(){u.pop();u.length===0&&f.success()})))}):r=n.files,u.length===0&&f.success()),f}function h(n){var o=new qq.UploadDropZone({HIDE_ZONES_EVENT_NAME:u,element:n,onEnter:function(i){qq(n).addClass(t.classes.dropActive);i.stopPropagation()},onLeaveNotDescendants:function(){qq(n).removeClass(t.classes.dropActive)},onDrop:function(n){l(n.dataTransfer,o).then(function(){c(r,o)},function(){t.callbacks.dropLog("Drop event DataTransfer parsing failed.  No files will be uploaded.","error")})}});return i.addDisposer(function(){o.dispose()}),qq(n).hasAttribute(f)&&qq(n).hide(),e.push(o),o}function a(n){var t;return qq.each(n.dataTransfer.types,function(n,i){if(i==="Files")return t=!0,!1}),t}function v(n){return qq.firefox()?!n.relatedTarget:qq.safari()?n.x<0||n.y<0:n.x===0&&n.y===0}function y(){var n=t.dropZoneElements,r=function(){setTimeout(function(){qq.each(n,function(n,i){qq(i).hasAttribute(f)&&qq(i).hide();qq(i).removeClass(t.classes.dropActive)})},10)};qq.each(n,function(t,r){var u=h(r);n.length&&(!qq.ie()||qq.ie10())&&i.attach(document,"dragenter",function(t){!u.dropDisabled()&&a(t)&&qq.each(n,function(n,t){t instanceof HTMLElement&&qq(t).css({display:"block"})})})});i.attach(document,"dragleave",function(n){v(n)&&r()});i.attach(qq(document).children()[0],"mouseenter",function(){r()});i.attach(document,"drop",function(n){n.preventDefault();r()});i.attach(document,u,r)}var t,u="qq-hidezones",f="qq-hide-dropzone",e=[],r=[],i=new qq.DisposeSupport;t={dropZoneElements:[],allowMultipleItems:!0,classes:{dropActive:null},callbacks:new qq.DragAndDrop.callbacks};qq.extend(t,n,!0);y();qq.extend(this,{setupExtraDropzone:function(n){t.dropZoneElements.push(n);h(n)},removeDropzone:function(n){var i,r=t.dropZoneElements;for(i in r)if(r[i]===n)return r.splice(i,1)},dispose:function(){i.dispose();qq.each(e,function(n,t){t.dispose()})}})};qq.DragAndDrop.callbacks=function(){"use strict";return{processingDroppedFiles:function(){},processingDroppedFilesComplete:function(){},dropError:function(n,t){qq.log("Drag & drop error code '"+n+" with these specifics: '"+t+"'","error")},dropLog:function(n,t){qq.log(n,t)}}};qq.UploadDropZone=function(n){"use strict";function s(){return qq.safari()||qq.firefox()&&qq.windows()}function h(){o||(s?i.attach(document,"dragover",function(n){n.preventDefault()}):i.attach(document,"dragover",function(n){n.dataTransfer&&(n.dataTransfer.dropEffect="none",n.preventDefault())}),o=!0)}function u(n){if(qq.ie()&&!qq.ie10())return!1;var i,t=n.dataTransfer,r=qq.safari();return i=qq.ie10()||qq.ie11()?!0:t.effectAllowed!=="none",t&&i&&(t.files||!r&&t.types.contains&&t.types.contains("Files"))}function f(n){return n!==undefined&&(e=n),e}function c(){function i(){n=document.createEvent("Event");n.initEvent(t.HIDE_ZONES_EVENT_NAME,!0,!0)}var n;if(window.CustomEvent)try{n=new CustomEvent(t.HIDE_ZONES_EVENT_NAME)}catch(r){i()}else i();document.dispatchEvent(n)}function l(){i.attach(r,"dragover",function(n){if(u(n)){var t=qq.ie()||qq.ie11()?null:n.dataTransfer.effectAllowed;n.dataTransfer.dropEffect=t==="move"||t==="linkMove"?"move":"copy";n.stopPropagation();n.preventDefault()}});i.attach(r,"dragenter",function(n){if(!f()){if(!u(n))return;t.onEnter(n)}});i.attach(r,"dragleave",function(n){if(u(n)){t.onLeave(n);var i=document.elementFromPoint(n.clientX,n.clientY);if(!qq(this).contains(i))t.onLeaveNotDescendants(n)}});i.attach(r,"drop",function(n){if(!f()){if(!u(n))return;n.preventDefault();n.stopPropagation();t.onDrop(n);c()}})}var i=new qq.DisposeSupport,t,r,e,o;t={element:null,onEnter:function(){},onLeave:function(){},onLeaveNotDescendants:function(){},onDrop:function(){}};qq.extend(t,n);r=t.element;h();l();qq.extend(this,{dropDisabled:function(n){return f(n)},dispose:function(){i.dispose()},getElement:function(){return r}})};qq.DeleteFileAjaxRequester=function(n){"use strict";function r(){return t.method.toUpperCase()==="POST"?{_method:"DELETE"}:{}}var i,t={method:"DELETE",uuidParamName:"qquuid",endpointStore:{},maxConnections:3,customHeaders:function(){return{}},paramsStore:{},demoMode:!1,cors:{expected:!1,sendCredentials:!1},log:function(){},onDelete:function(){},onDeleteComplete:function(){}};qq.extend(t,n);i=qq.extend(this,new qq.AjaxRequester({acceptHeader:"application/json",validMethods:["POST","DELETE"],method:t.method,endpointStore:t.endpointStore,paramsStore:t.paramsStore,mandatedParams:r(),maxConnections:t.maxConnections,customHeaders:function(n){return t.customHeaders.get(n)},demoMode:t.demoMode,log:t.log,onSend:t.onDelete,onComplete:t.onDeleteComplete,cors:t.cors}));qq.extend(this,{sendDelete:function(n,r,u){var f=u||{};t.log("Submitting delete file request for "+n);t.method==="DELETE"?i.initTransport(n).withPath(r).withParams(f).send():(f[t.uuidParamName]=r,i.initTransport(n).withParams(f).send())}})},function(){function i(n){var r=n.naturalWidth,u=n.naturalHeight,t,i;return r*u>1048576?(t=document.createElement("canvas"),t.width=t.height=1,i=t.getContext("2d"),i.drawImage(n,-r+1,0),i.getImageData(0,0,1,1).data[3]===0):!1}function r(n,t,i){var u=document.createElement("canvas"),f,h,o;u.width=1;u.height=i;f=u.getContext("2d");f.drawImage(n,0,0);for(var c=f.getImageData(0,0,1,i).data,e=0,s=i,r=i;r>e;)h=c[(r-1)*4+3],h===0?s=r:e=r,r=s+e>>1;return o=r/i,o===0?1:o}function u(t,i,r){var u=document.createElement("canvas"),f=i.mime||"image/jpeg";return n(t,u,i,r),u.toDataURL(f,i.quality||.8)}function f(n){var t=5241e3;if(!qq.ios())throw new qq.Error("Downsampled dimensions can only be reliably calculated for iOS!");if(n.origHeight*n.origWidth>t)return{newHeight:Math.round(Math.sqrt(t*(n.origHeight/n.origWidth))),newWidth:Math.round(Math.sqrt(t*(n.origWidth/n.origHeight)))}}function n(n,t,u,o){var v=n.naturalWidth,y=n.naturalHeight,h=u.width,c=u.height,p=t.getContext("2d"),l,g,s,a,w,d;if(p.save(),qq.supportedFeatures.unlimitedScaledImageSize||(l=f({origWidth:h,origHeight:c}),l&&(qq.log(qq.format("Had to reduce dimensions due to device limitations from {}w / {}h to {}w / {}h",h,c,l.newWidth,l.newHeight),"warn"),h=l.newWidth,c=l.newHeight)),e(t,h,c,u.orientation),qq.ios()){g=i(n);g&&(v/=2,y/=2);s=1024;a=document.createElement("canvas");a.width=a.height=s;for(var b=a.getContext("2d"),rt=o?r(n,v,y):1,nt=Math.ceil(s*h/v),tt=Math.ceil(s*c/y/rt),k=0,it=0;k<y;){for(w=0,d=0;w<v;)b.clearRect(0,0,s,s),b.drawImage(n,-w,-k),p.drawImage(a,0,0,s,s,d,it,nt,tt),w+=s,d+=nt;k+=s;it+=tt}p.restore();a=b=null}else p.drawImage(n,0,0,h,c);t.qqImageRendered&&t.qqImageRendered()}function e(n,t,i,r){switch(r){case 5:case 6:case 7:case 8:n.width=i;n.height=t;break;default:n.width=t;n.height=i}var u=n.getContext("2d");switch(r){case 2:u.translate(t,0);u.scale(-1,1);break;case 3:u.translate(t,i);u.rotate(Math.PI);break;case 4:u.translate(0,i);u.scale(1,-1);break;case 5:u.rotate(.5*Math.PI);u.scale(1,-1);break;case 6:u.rotate(.5*Math.PI);u.translate(0,-i);break;case 7:u.rotate(.5*Math.PI);u.translate(t,-i);u.scale(-1,1);break;case 8:u.rotate(-.5*Math.PI);u.translate(-t,0)}}function t(n,t){var i,r,u;if(window.Blob&&n instanceof Blob){if(i=new Image,r=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null,!r)throw Error("No createObjectURL function found to create blob url");i.src=r.createObjectURL(n);this.blob=n;n=i}n.naturalWidth||n.naturalHeight||(u=this,n.onload=function(){var n=u.imageLoadListeners;n&&(u.imageLoadListeners=null,setTimeout(function(){for(var t=0,i=n.length;t<i;t++)n[t]()},0))},n.onerror=t,this.imageLoadListeners=[]);this.srcImage=n}t.prototype.render=function(t,i){var v,s,l,a;if(this.imageLoadListeners){v=this;this.imageLoadListeners.push(function(){v.render(t,i)});return}i=i||{};var e=this.srcImage.naturalWidth,o=this.srcImage.naturalHeight,r=i.width,f=i.height,h=i.maxWidth,c=i.maxHeight,y=!this.blob||this.blob.type==="image/jpeg";r&&!f?f=o*r/e<<0:f&&!r?r=e*f/o<<0:(r=e,f=o);h&&r>h&&(r=h,f=o*r/e<<0);c&&f>c&&(f=c,r=e*f/o<<0);s={width:r,height:f};for(l in i)s[l]=i[l];if(a=t.tagName.toLowerCase(),a==="img"?t.src=u(this.srcImage,s,y):a==="canvas"&&n(this.srcImage,t,s,y),typeof this.onrender=="function")this.onrender(t)};qq.MegaPixImage=t}();qq.ImageGenerator=function(n){"use strict";function i(n){return n.tagName.toLowerCase()==="img"}function r(n){return n.tagName.toLowerCase()==="canvas"}function s(){return(new Image).crossOrigin!==undefined}function h(){var n=document.createElement("canvas");return n.getContext&&n.getContext("2d")}function f(n){var i=n.split("/"),r=i[i.length-1],t=qq.getExtension(r);t=t&&t.toLowerCase();switch(t){case"jpeg":case"jpg":return"image/jpeg";case"png":return"image/png";case"bmp":return"image/bmp";case"gif":return"image/gif";case"tiff":case"tif":return"image/tiff"}}function u(n){var t=document.createElement("a"),i,r,u;return(t.href=n,i=t.protocol,u=t.port,r=t.hostname,i.toLowerCase()!==window.location.protocol.toLowerCase())?!0:r.toLowerCase()!==window.location.hostname.toLowerCase()?!0:u!==window.location.port&&!qq.ie()?!0:!1}function c(t,i){t.onload=function(){t.onload=null;t.onerror=null;i.success(t)};t.onerror=function(){t.onload=null;t.onerror=null;n("Problem drawing thumbnail!","error");i.failure(t,"Problem drawing thumbnail!")}}function l(n,t){n.qqImageRendered=function(){t.success(n)}}function t(t,u){var f=i(t)||r(t);return i(t)?c(t,u):r(t)?l(t,u):(u.failure(t),n(qq.format("Element container of type {} is not supported!",t.tagName),"error")),f}function a(i,r,u){var f=new qq.Promise,o=new qq.Identify(i,n),e=u.maxSize,s=u.orient==null?!0:u.orient,h=function(){r.onerror=null;r.onload=null;n("Could not render preview, file may be too large!","error");f.failure(r,"Browser cannot render image!")};return o.isPreviewable().then(function(u){var c={parse:function(){return(new qq.Promise).success()}},l=s?new qq.Exif(i,n):c,o=new qq.MegaPixImage(i,h);t(r,f)&&l.parse().then(function(n){var t=n&&n.Orientation;o.render(r,{maxWidth:e,maxHeight:e,orientation:t,mime:u})},function(t){n(qq.format("EXIF data could not be parsed ({}).  Assuming orientation = 1.",t));o.render(r,{maxWidth:e,maxHeight:e,mime:u})})},function(){n("Not previewable");f.failure(r,"Not previewable")}),f}function e(n,i,r,e){var o=new Image,s=new qq.Promise;t(o,s);u(n)&&(o.crossOrigin="anonymous");o.src=n;s.then(function(){t(i,r);var u=new qq.MegaPixImage(o);u.render(i,{maxWidth:e,maxHeight:e,mime:f(n)})})}function o(n,i,r,u){t(i,r);qq(i).css({maxWidth:u+"px",maxHeight:u+"px"});i.src=n}function v(n,f,c){var l=new qq.Promise,v=c.scale,a=v?c.maxSize:null;return v&&i(f)?h()?u(n)&&!s()?o(n,f,l,a):e(n,f,l,a):o(n,f,l,a):r(f)?e(n,f,l,a):t(f,l)&&(f.src=n),l}qq.extend(this,{generate:function(t,i,r){return qq.isString(t)?(n("Attempting to update thumbnail based on server response."),v(t,i,r||{})):(n("Attempting to draw client-side image preview."),a(t,i,r||{}))}});this._testing={};this._testing.isImg=i;this._testing.isCanvas=r;this._testing.isCrossOrigin=u;this._testing.determineMimeOfFileName=f};qq.Exif=function(n,t){"use strict";function i(n){for(var t=0,i=0;n.length>0;)t+=parseInt(n.substring(0,2),16)*Math.pow(2,i),n=n.substring(2,n.length),i+=8;return t}function u(t,i){var r=t,f=i;return r===undefined&&(r=2,f=new qq.Promise),qq.readBlobToHex(n,r,4).then(function(n){var t=/^ffe([0-9])/.exec(n),i;t?t[1]!=="1"?(i=parseInt(n.slice(4,8),16),u(r+i+2,f)):f.success(r):f.failure("No EXIF header to be found!")}),f}function e(){var t=new qq.Promise;return qq.readBlobToHex(n,0,6).then(function(n){n.indexOf("ffd8")!==0?t.failure("Not a valid JPEG!"):u().then(function(n){t.success(n)},function(n){t.failure(n)})}),t}function o(t){var i=new qq.Promise;return qq.readBlobToHex(n,t+10,2).then(function(n){i.success(n==="4949")}),i}function s(t,r){var u=new qq.Promise;return qq.readBlobToHex(n,t+18,2).then(function(n){if(r)return u.success(i(n));u.success(parseInt(n,16))}),u}function h(t,i){var r=t+20,u=i*12;return qq.readBlobToHex(n,r,u)}function c(n){for(var i=[],t=0;t+24<=n.length;)i.push(n.slice(t,t+24)),t+=24;return i}function l(n,t){var e=16,u=qq.extend([],f),o={};return qq.each(t,function(t,f){var c=f.slice(0,4),s=n?i(c):parseInt(c,16),l=u.indexOf(s),h,a,v;return l>=0&&(a=r[s].name,v=r[s].bytes,h=f.slice(e,e+v*2),o[a]=n?i(h):parseInt(h,16),u.splice(l,1)),u.length===0?!1:void 0}),o}var f=[274],r={274:{name:"Orientation",bytes:2}};qq.extend(this,{parse:function(){var r=new qq.Promise,i=function(n){t(qq.format("EXIF header parse failed: '{}' ",n));r.failure(n)};return e().then(function(u){t(qq.format("Moving forward with EXIF header parsing for '{}'",n.name===undefined?"blob":n.name));o(u).then(function(n){t(qq.format("EXIF Byte order is {} endian",n?"little":"big"));s(u,n).then(function(f){t(qq.format("Found {} APP1 directory entries",f));h(u,f).then(function(i){var u=c(i),f=l(n,u);t("Successfully parsed some EXIF tags");r.success(f)},i)},i)},i)},i),r}});this._testing={};this._testing.parseLittleEndian=i};qq.Identify=function(n,t){"use strict";function i(n,t){var i=!1,r=[].concat(n);return qq.each(r,function(n,r){if(t.indexOf(r)===0)return i=!0,!1}),i}qq.extend(this,{isPreviewable:function(){var e=this,r=new qq.Promise,u=!1,f=n.name===undefined?"blob":n.name;return t(qq.format("Attempting to determine if {} can be rendered in this browser",f)),t("First pass: check type attribute of blob object."),this.isPreviewableSync()?(t("Second pass: check for magic bytes in file header."),qq.readBlobToHex(n,0,4).then(function(n){qq.each(e.PREVIEWABLE_MIME_TYPES,function(t,f){if(i(f,n))return(t!=="image/tiff"||qq.supportedFeatures.tiffPreviews)&&(u=!0,r.success(t)),!1});t(qq.format("'{}' is {} able to be rendered in this browser",f,u?"":"NOT"));u||r.failure()},function(){t("Error reading file w/ name '"+f+"'.  Not able to be rendered in this browser.");r.failure()})):r.failure(),r},isPreviewableSync:function(){var r=n.type,u=qq.indexOf(Object.keys(this.PREVIEWABLE_MIME_TYPES),r)>=0,i=!1,f=n.name===undefined?"blob":n.name;return u&&(i=r==="image/tiff"?qq.supportedFeatures.tiffPreviews:!0),i||t(f+" is not previewable in this browser per the blob's type attr"),i}})};qq.Identify.prototype.PREVIEWABLE_MIME_TYPES={"image/jpeg":"ffd8ff","image/gif":"474946","image/png":"89504e","image/bmp":"424d","image/tiff":["49492a00","4d4d002a"]};qq.ImageValidation=function(n,t){"use strict";function i(n){var t=!1;return qq.each(n,function(n,i){if(i>0)return t=!0,!1}),t}function r(){var i=new qq.Promise;return new qq.Identify(n,t).isPreviewable().then(function(){var r=new Image,u=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;u?(r.onerror=function(){t("Cannot determine dimensions for image.  May be too large.","error");i.failure()},r.onload=function(){i.success({width:this.width,height:this.height})},r.src=u.createObjectURL(n)):(t("No createObjectURL function available to generate image URL!","error"),i.failure())},i.failure),i}function u(n,t){var i;return qq.each(n,function(n,r){if(r>0){var u=/(max|min)(Width|Height)/.exec(n),e=u[2].charAt(0).toLowerCase()+u[2].slice(1),f=t[e];switch(u[1]){case"min":if(f<r)return i=n,!1;break;case"max":if(f>r)return i=n,!1}}}),i}this.validate=function(n){var f=new qq.Promise;return t("Attempting to validate image."),i(n)?r().then(function(t){var i=u(n,t);i?f.failure(i):f.success()},f.success):f.success(),f}};qq.Session=function(n){"use strict";function i(n){if(qq.isArray(n))return!0;t.log("Session response is not an array.","error")}function r(n,r,u,f){var e=!1;r=r&&i(n);r&&qq.each(n,function(n,i){if(i.uuid==null)e=!0,t.log(qq.format("Session response item {} did not include a valid UUID - ignoring.",n),"error");else if(i.name==null)e=!0,t.log(qq.format("Session response item {} did not include a valid name - ignoring.",n),"error");else try{return t.addFileRecord(i),!0}catch(r){e=!0;t.log(r.message,"error")}return!1});f[r&&!e?"success":"failure"](n,u)}var t={endpoint:null,params:{},customHeaders:{},cors:{},addFileRecord:function(){},log:function(){}};qq.extend(t,n,!0);this.refresh=function(){var n=new qq.Promise,i=function(t,i,u){r(t,i,u,n)},u=qq.extend({},t),f=new qq.SessionAjaxRequester(qq.extend(u,{onComplete:i}));return f.queryServer(),n}};qq.SessionAjaxRequester=function(n){"use strict";function r(n,i,r){var u=null;if(i.responseText!=null)try{u=qq.parseJson(i.responseText)}catch(f){t.log("Problem parsing session response: "+f.message,"error");r=!0}t.onComplete(u,!r,i)}var i,t={endpoint:null,customHeaders:{},params:{},cors:{expected:!1,sendCredentials:!1},onComplete:function(){},log:function(){}};qq.extend(t,n);i=qq.extend(this,new qq.AjaxRequester({acceptHeader:"application/json",validMethods:["GET"],method:"GET",endpointStore:{get:function(){return t.endpoint}},customHeaders:t.customHeaders,log:t.log,onComplete:r,cors:t.cors}));qq.extend(this,{queryServer:function(){var n=qq.extend({},t.params);t.log("Session query request.");i.initTransport("sessionRefresh").withParams(n).withCacheBuster().send()}})};qq.FormSupport=function(n,t,i){"use strict";function s(n){n.getAttribute("action")&&(u.newEndpoint=n.getAttribute("action"))}function f(n,t){if(n.checkValidity&&!n.checkValidity())i("Form did not pass validation checks - will not upload.","error"),t();else return!0}function h(n){var i=n.submit;qq(n).attach("submit",function(r){r=r||window.event;r.preventDefault?r.preventDefault():r.returnValue=!1;f(n,i)&&t()});n.submit=function(){f(n,i)&&t()}}function c(n){return n&&(qq.isString(n)&&(n=document.getElementById(n)),n&&(i("Attaching to form element."),s(n),e&&h(n))),n}var u=this,e=n.interceptSubmit,r=n.element,o=n.autoUpload;qq.extend(this,{newEndpoint:null,newAutoUpload:o,attachedToForm:!1,getFormInputsAsObject:function(){return r==null?null:u._form2Obj(r)}});r=c(r);this.attachedToForm=!!r};qq.extend(qq.FormSupport.prototype,{_form2Obj:function(n){"use strict";var t={},r=function(n){return qq.indexOf(["button","image","reset","submit"],n.toLowerCase())<0},u=function(n){return qq.indexOf(["checkbox","radio"],n.toLowerCase())>=0},i=function(n){return u(n.type)&&!n.checked?!0:n.disabled&&n.type.toLowerCase()!=="hidden"},f=function(n){var t=null;return qq.each(qq(n).children(),function(n,i){if(i.tagName.toLowerCase()==="option"&&i.selected)return t=i.value,!1}),t};return qq.each(n.elements,function(n,u){if((qq.isInput(u,!0)||u.tagName.toLowerCase()==="textarea")&&r(u.type)&&!i(u))t[u.name]=u.value;else if(u.tagName.toLowerCase()==="select"&&!i(u)){var e=f(u);e!==null&&(t[u.name]=e)}}),t}});qq.Scaler=function(n,t){"use strict";var h=this,r=n.sendOriginal,u=n.orient,f=n.defaultType,e=n.defaultQuality/100,o=n.failureText,s=n.includeExif,i=this._getSortedSizes(n.sizes);qq.extend(this,{enabled:qq.supportedFeatures.scaling&&i.length>0,getFileRecords:function(n,h,c){var a=this,v=[],l=c.blob?c.blob:c,y=new qq.Identify(l,t);return y.isPreviewableSync()?(qq.each(i,function(n,i){var r=a._determineOutputType({defaultType:f,requestedType:i.type,refType:l.type});v.push({uuid:qq.getUniqueId(),name:a._getName(h,{name:i.name,type:r,refType:l.type}),blob:new qq.BlobProxy(l,qq.bind(a._generateScaledImage,a,{maxSize:i.maxSize,orient:u,type:r,quality:e,failedText:o,includeExif:s,log:t}))})}),r&&v.push({uuid:n,name:h,blob:l})):v.push({uuid:n,name:h,blob:l}),v},handleNewFile:function(n,t,i,r,u,f,e,o){var a=this,p=n.qqButtonId||n.blob&&n.blob.qqButtonId,c=[],s=null,v=o.addFileToHandler,h=o.uploadData,l=o.paramsStore,y=qq.getUniqueId();qq.each(a.getFileRecords(i,t,n),function(t,i){var o=n,l=r,f;i.blob instanceof qq.BlobProxy&&(o=i.blob,l=-1);f=h.addFile({uuid:i.uuid,name:i.name,size:l,batchId:e,proxyGroupId:y});i.blob instanceof qq.BlobProxy?c.push(f):s=f;v(f,o);u.push({id:f,file:o})});s!==null&&(qq.each(c,function(n,t){var i={qqparentuuid:h.retrieve({id:s}).uuid,qqparentsize:h.retrieve({id:s}).size};i[f]=h.retrieve({id:t}).uuid;h.setParentId(t,s);l.addReadOnly(t,i)}),c.length&&function(){var n={};n[f]=h.retrieve({id:s}).uuid;l.addReadOnly(s,n)}())}})};qq.extend(qq.Scaler.prototype,{scaleImage:function(n,t,i){"use strict";if(!qq.supportedFeatures.scaling)throw new qq.Error("Scaling is not supported in this browser!");var r=new qq.Promise,f=i.log,e=i.getFile(n),u=i.uploadData.retrieve({id:n}),o=u&&u.name,s=u&&u.uuid,h={sendOriginal:!1,orient:t.orient,defaultType:t.type||null,defaultQuality:t.quality,failedToScaleText:"Unable to scale",sizes:[{name:"",maxSize:t.maxSize}]},c=new qq.Scaler(h,f);return qq.Scaler&&qq.supportedFeatures.imagePreviews&&e?qq.bind(function(){var t=c.getFileRecords(s,o,e)[0];t&&t.blob instanceof qq.BlobProxy?t.blob.create().then(r.success,r.failure):(f(n+" is not a scalable image!","error"),r.failure())},this)():(r.failure(),f("Could not generate requested scaled image for "+n+".  Scaling is either not possible in this browser, or the file could not be located.","error")),r},_determineOutputType:function(n){"use strict";var t=n.requestedType,i=n.defaultType,r=n.refType;return!i&&!t?r!=="image/jpeg"?"image/png":r:t?qq.indexOf(Object.keys(qq.Identify.prototype.PREVIEWABLE_MIME_TYPES),t)>=0?t==="image/tiff"?qq.supportedFeatures.tiffPreviews?t:i:t:i:i},_getName:function(n,t){"use strict";var r=n.lastIndexOf("."),u=" ("+t.name+")",f=t.type||"image/png",o=t.refType,i="",e=qq.getExtension(n);return r>=0?(i=n.substr(0,r),o!==f&&(e=f.split("/")[1]),i+=u+"."+e):i=n+u,i},_getSortedSizes:function(n){"use strict";return n=qq.extend([],n),n.sort(function(n,t){return n.maxSize>t.maxSize?1:n.maxSize<t.maxSize?-1:0})},_generateScaledImage:function(n,t){"use strict";var u=this,i=n.log,o=n.maxSize,s=n.orient,f=n.type,h=n.quality,c=n.failedText,l=n.includeExif&&t.type==="image/jpeg"&&f==="image/jpeg",r=new qq.Promise,a=new qq.ImageGenerator(i),e=document.createElement("canvas");return i("Attempting to generate scaled version for "+t.name),a.generate(t,e,{maxSize:o,orient:s}).then(function(){var n=e.toDataURL(f,h),o=function(){i("Success generating scaled version for "+t.name);var f=u._dataUriToBlob(n);r.success(f)};l?u._insertExifHeader(t,n,i).then(function(t){n=t;o()},function(){i("Problem inserting EXIF header into scaled image.  Using scaled image w/out EXIF data.","error");o()}):o()},function(){i("Failed attempt to generate scaled version for "+t.name,"error");r.failure(c)}),r},_insertExifHeader:function(n,t,i){"use strict";var r=new FileReader,u=new qq.Promise,f="";return r.onload=function(){f=r.result;u.success(ExifRestorer.restore(f,t))},r.onerror=function(){i("Problem reading "+n.name+" during attempt to transfer EXIF data to scaled version.","error");u.failure()},r.readAsDataURL(n),u},_dataUriToBlob:function(n){"use strict";var t,r,i,u;return t=n.split(",")[0].indexOf("base64")>=0?atob(n.split(",")[1]):decodeURI(n.split(",")[1]),r=n.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),u=new Uint8Array(i),qq.each(t,function(n,t){u[n]=t.charCodeAt(0)}),this._createBlob(i,r)},_createBlob:function(n,t){"use strict";var r=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,i=r&&new r;return i?(i.append(n),i.getBlob(t)):new Blob([n],{type:t})}});ExifRestorer=function(){var n={};return n.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n.encode64=function(n){var o="",u,t,i="",s,h,f,r="",e=0;do u=n[e++],t=n[e++],i=n[e++],s=u>>2,h=(u&3)<<4|t>>4,f=(t&15)<<2|i>>6,r=i&63,isNaN(t)?f=r=64:isNaN(i)&&(r=64),o=o+this.KEY_STR.charAt(s)+this.KEY_STR.charAt(h)+this.KEY_STR.charAt(f)+this.KEY_STR.charAt(r),u=t=i="",s=h=f=r="";while(e<n.length);return o},n.restore=function(n,t){var i="data:image/jpeg;base64,";if(!n.match(i))return t;var r=this.decode64(n.replace(i,"")),u=this.slice2Segments(r),f=this.exifManipulation(t,u);return i+this.encode64(f)},n.exifManipulation=function(n,t){var i=this.getExifArray(t),r=this.insertExif(n,i);return new Uint8Array(r)},n.getExifArray=function(n){for(var t,i=0;i<n.length;i++)if(t=n[i],t[0]==255&t[1]==225)return t;return[]},n.insertExif=function(n,t){var f=n.replace("data:image/jpeg;base64,",""),i=this.decode64(f),u=i.indexOf(255,3),e=i.slice(0,u),o=i.slice(u),r=e;return r=r.concat(t),r.concat(o)},n.slice2Segments=function(n){for(var t=0,i=[];;){if(n[t]==255&n[t+1]==218)break;if(n[t]==255&n[t+1]==216)t+=2;else{var u=n[t+2]*256+n[t+3],r=t+u+2,f=n.slice(t,r);i.push(f);t=r}if(t>n.length)break}return i},n.decode64=function(n){var e,o,s="",h,r,t,u="",i=0,f=[];if(/[^A-Za-z0-9\+\/\=]/g.exec(n))throw new Error("There were invalid base64 characters in the input text.  Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='");n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");do h=this.KEY_STR.indexOf(n.charAt(i++)),r=this.KEY_STR.indexOf(n.charAt(i++)),t=this.KEY_STR.indexOf(n.charAt(i++)),u=this.KEY_STR.indexOf(n.charAt(i++)),e=h<<2|r>>4,o=(r&15)<<4|t>>2,s=(t&3)<<6|u,f.push(e),t!=64&&f.push(o),u!=64&&f.push(s),e=o=s="",h=r=t=u="";while(i<n.length);return f},n}();qq.TotalProgress=function(n,t){"use strict";var i={},u=0,r=0,e=-1,o=-1,s=function(t,i){(t!==e||i!==o)&&n(t,i);e=t;o=i},c=function(n,t){var i=!0;return qq.each(n,function(n,r){if(qq.indexOf(t,r)>=0)return i=!1,!1}),i},l=function(n){f(n,-1,-1);delete i[n]},a=function(n,t,i){(t.length===0||c(t,i))&&(s(r,r),this.reset())},h=function(n){var r=t(n);r>0&&(f(n,0,r),i[n]={loaded:0,total:r})},f=function(n,t,f){var e=i[n]?i[n].loaded:0,o=i[n]?i[n].total:0;t===-1&&f===-1?(u-=e,r-=o):(t&&(u+=t-e),f&&(r+=f-o));s(u,r)};qq.extend(this,{onAllComplete:a,onStatusChange:function(n,t,i){i===qq.status.CANCELED||i===qq.status.REJECTED?l(n):i===qq.status.SUBMITTING&&h(n)},onIndividualProgress:function(n,t,r){f(n,t,r);i[n]={loaded:t,total:r}},onNewSize:function(n){h(n)},reset:function(){i={};u=0;r=0}})};qq.UiEventHandler=function(n,t){"use strict";function u(n){r.attach(n,i.eventType,function(n){n=n||window.event;var t=n.target||n.srcElement;i.onHandled(t,n)})}var r=new qq.DisposeSupport,i={eventType:"click",attachTo:null,onHandled:function(){}};qq.extend(this,{addHandler:function(n){u(n)},dispose:function(){r.dispose()}});qq.extend(t,{getFileIdFromItem:function(n){return n.qqFileId},getDisposeSupport:function(){return r}});qq.extend(i,n);i.attachTo&&u(i.attachTo)};qq.FileButtonsClickHandler=function(n){"use strict";function r(n,r){qq.each(i,function(i,u){var e=i.charAt(0).toUpperCase()+i.slice(1),f;if(t.templating["is"+e](n))return f=t.templating.getFileId(n),qq.preventDefault(r),t.log(qq.format("Detected valid file button click event on file '{}', ID: {}.",t.onGetName(f),f)),u(f),!1})}var t={templating:null,log:function(){},onDeleteFile:function(){},onCancel:function(){},onRetry:function(){},onPause:function(){},onContinue:function(){},onGetName:function(){}},i={cancel:function(n){t.onCancel(n)},retry:function(n){t.onRetry(n)},deleteButton:function(n){t.onDeleteFile(n)},pause:function(n){t.onPause(n)},continueButton:function(n){t.onContinue(n)}};qq.extend(t,n);t.eventType="click";t.onHandled=r;t.attachTo=t.templating.getFileList();qq.extend(this,new qq.UiEventHandler(t,{}))};qq.FilenameClickHandler=function(n){"use strict";function r(n,r){if(t.templating.isFileName(n)||t.templating.isEditIcon(n)){var u=t.templating.getFileId(n),f=t.onGetUploadStatus(u);f===qq.status.SUBMITTED&&(t.log(qq.format("Detected valid filename click event on file '{}', ID: {}.",t.onGetName(u),u)),qq.preventDefault(r),i.handleFilenameEdit(u,n,!0))}}var i={},t={templating:null,log:function(){},classes:{file:"qq-upload-file",editNameIcon:"qq-edit-filename-icon"},onGetUploadStatus:function(){},onGetName:function(){}};qq.extend(t,n);t.eventType="click";t.onHandled=r;qq.extend(this,new qq.FilenameEditHandler(t,i))};qq.FilenameInputFocusInHandler=function(n,t){"use strict";function r(n){if(i.templating.isEditInput(n)){var r=i.templating.getFileId(n),u=i.onGetUploadStatus(r);u===qq.status.SUBMITTED&&(i.log(qq.format("Detected valid filename input focus event on file '{}', ID: {}.",i.onGetName(r),r)),t.handleFilenameEdit(r,n))}}var i={templating:null,onGetUploadStatus:function(){},log:function(){}};t||(t={});i.eventType="focusin";i.onHandled=r;qq.extend(i,n);qq.extend(this,new qq.FilenameEditHandler(i,t))};qq.FilenameInputFocusHandler=function(n){"use strict";n.eventType="focus";n.attachTo=null;qq.extend(this,new qq.FilenameInputFocusInHandler(n,{}))};qq.FilenameEditHandler=function(n,t){"use strict";function u(n){var t=i.onGetName(n),r=t.lastIndexOf(".");return r>0&&(t=t.substr(0,r)),t}function f(n){var t=i.onGetName(n);return qq.getExtension(t)}function r(n,t){var r=n.value,u;if(r!==undefined&&qq.trimStr(r).length>0){u=f(t);u!==undefined&&(r=r+"."+u);i.onSetName(t,r)}i.onEditingStatusChange(t,!1)}function e(n,i){t.getDisposeSupport().attach(n,"blur",function(){r(n,i)})}function o(n,i){t.getDisposeSupport().attach(n,"keyup",function(t){var u=t.keyCode||t.which;u===13&&r(n,i)})}var i={templating:null,log:function(){},onGetUploadStatus:function(){},onGetName:function(){},onSetName:function(){},onEditingStatusChange:function(){}};qq.extend(i,n);i.attachTo=i.templating.getFileList();qq.extend(this,new qq.UiEventHandler(i,t));qq.extend(t,{handleFilenameEdit:function(n,t,r){var f=i.templating.getEditInput(n);i.onEditingStatusChange(n,!0);f.value=u(n);r&&f.focus();e(f,n);o(f,n)}})},function(n){"use strict";function s(n){var u=r(n||{}),f=h(u);return i(f),c(u,f),t}function h(n){var t=u("uploaderType"),i=u("endpointType");return t?(t=t.charAt(0).toUpperCase()+t.slice(1).toLowerCase(),i)?new qq[i]["FineUploader"+t](n):new qq["FineUploader"+t](n):i?new qq[i].FineUploader(n):new qq.FineUploader(n)}function f(n,i){var r=t.data("fineuploader");if(i)r===undefined&&(r={}),r[n]=i,t.data("fineuploader",r);else return r===undefined?null:r[n]}function i(n){return f("uploader",n)}function u(n,t){return f(n,t)}function c(i,r){var u=i.callbacks={};n.each(r._options.callbacks,function(i,r){var f,o;f=/^on(\w+)/.exec(i)[1];f=f.substring(0,1).toLowerCase()+f.substring(1);o=t;u[i]=function(){var i=Array.prototype.slice.call(arguments),u=[],t,s;n.each(i,function(n,t){u.push(e(t))});t=r.apply(this,i);try{s=o.triggerHandler(f,u)}catch(h){qq.log("Caught error in Fine Uploader jQuery event handler: "+h.message,"error")}return t!=null?t:s}});r._options.callbacks=u}function r(i,f){var e,s;return e=f===undefined?i.uploaderType!=="basic"?{element:t[0]}:{}:f,n.each(i,function(t,i){n.inArray(t,o)>=0?u(t,i):i instanceof n?e[t]=i[0]:n.isPlainObject(i)?(e[t]={},r(i,e[t])):n.isArray(i)?(s=[],n.each(i,function(t,i){var u={};i instanceof n?n.merge(s,i):n.isPlainObject(i)?(r(i,u),s.push(u)):s.push(i)}),e[t]=s):e[t]=i}),f===undefined?e:void 0}function l(t){return n.type(t)==="string"&&!t.match(/^_/)&&i()[t]!==undefined}function a(n){var t=[],f=Array.prototype.slice.call(arguments,1),u;return r(f,t),u=i()[n].apply(i(),t),e(u)}function e(t){var i=t;return t!=null&&typeof t=="object"&&(t.nodeType===1||t.nodeType===9)&&t.cloneNode&&(i=n(t)),i}var t,o=["uploaderType","endpointType"];n.fn.fineUploader=function(r){var f=this,e=arguments,u=[];return(this.each(function(o,h){if(t=n(h),i()&&l(r)){if(u.push(a.apply(f,e)),f.length===1)return!1}else typeof r!="object"&&r?n.error("Method "+r+" does not exist on jQuery.fineUploader"):s.apply(f,e)}),u.length===1)?u[0]:u.length>1?u:this}}(jQuery),function(n){"use strict";function f(n){n||(n={});n.dropZoneElements=[t];var u=r(n);return o(u),i(new qq.DragAndDrop(u)),t}function e(n,i){var r=t.data(u);if(i)r===undefined&&(r={}),r[n]=i,t.data(u,r);else return r===undefined?null:r[n]}function i(n){return e("dndInstance",n)}function o(i){var r=i.callbacks={};n.each(new qq.DragAndDrop.callbacks,function(n){var u=n,i;i=t;r[n]=function(){var n=Array.prototype.slice.call(arguments);return i.triggerHandler(u,n)}})}function r(t,i){var u,f;return u=i===undefined?{}:i,n.each(t,function(t,i){i instanceof n?u[t]=i[0]:n.isPlainObject(i)?(u[t]={},r(i,u[t])):n.isArray(i)?(f=[],n.each(i,function(t,i){i instanceof n?n.merge(f,i):f.push(i)}),u[t]=f):u[t]=i}),i===undefined?u:void 0}function s(t){return n.type(t)==="string"&&t==="dispose"&&i()[t]!==undefined}function h(n){var t=[],u=Array.prototype.slice.call(arguments,1);return r(u,t),i()[n].apply(i(),t)}var u="fineUploaderDnd",t;n.fn.fineUploaderDnd=function(r){var e=this,o=arguments,u=[];return(this.each(function(c,l){if(t=n(l),i()&&s(r)){if(u.push(h.apply(e,o)),e.length===1)return!1}else typeof r!="object"&&r?n.error("Method "+r+" does not exist in Fine Uploader's DnD module."):f.apply(e,o)}),u.length===1)?u[0]:u.length>1?u:this}}(jQuery);+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.tooltip"),f=typeof i=="object"&&i;(r||i!="destroy")&&(r||u.data("bs.tooltip",r=new t(this,f)),typeof i=="string"&&r[i]())})}var t=function(n,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null;this.init("tooltip",n,t)},i;t.VERSION="3.2.0";t.TRANSITION_DURATION=150;t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"><\/div><div class="tooltip-inner"><\/div><\/div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}};t.prototype.init=function(t,i,r){var f,e,u,o,s;for(this.enabled=!0,this.type=t,this.$element=n(i),this.options=this.getOptions(r),this.$viewport=this.options.viewport&&n(this.options.viewport.selector||this.options.viewport),f=this.options.trigger.split(" "),e=f.length;e--;)if(u=f[e],u=="click")this.$element.on("click."+this.type,this.options.selector,n.proxy(this.toggle,this));else if(u!="manual"){o=u=="hover"?"mouseenter":"focusin";s=u=="hover"?"mouseleave":"focusout";this.$element.on(o+"."+this.type,this.options.selector,n.proxy(this.enter,this));this.$element.on(s+"."+this.type,this.options.selector,n.proxy(this.leave,this))}this.options.selector?this._options=n.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()};t.prototype.getDefaults=function(){return t.DEFAULTS};t.prototype.getOptions=function(t){return t=n.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t};t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&n.each(this._options,function(n,r){i[n]!=r&&(t[n]=r)}),t};t.prototype.enter=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget).data("bs."+this.type);if(i&&i.$tip&&i.$tip.is(":visible")){i.hoverState="in";return}if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout(function(){i.hoverState=="in"&&i.show()},i.options.delay.show)};t.prototype.leave=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout(function(){i.hoverState=="out"&&i.hide()},i.options.delay.hide)};t.prototype.show=function(){var c=n.Event("show.bs."+this.type),l,p,h;if(this.hasContent()&&this.enabled){if(this.$element.trigger(c),l=n.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]),c.isDefaultPrevented()||!l)return;var e=this,r=this.tip(),a=this.getUID(this.type);this.setContent();r.attr("id",a);this.$element.attr("aria-describedby",a);this.options.animation&&r.addClass("fade");var i=typeof this.options.placement=="function"?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,v=/\s?auto?\s?/i,y=v.test(i);y&&(i=i.replace(v,"")||"top");r.detach().css({top:0,left:0,display:"block"}).addClass(i).data("bs."+this.type,this);this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element);var u=this.getPosition(),o=r[0].offsetWidth,s=r[0].offsetHeight;if(y){var w=i,b=this.$element.parent(),f=this.getPosition(b);i=i=="bottom"&&u.top+u.height+s-f.scroll>f.height?"top":i=="top"&&u.top-f.scroll-s<f.top?"bottom":i=="right"&&u.right+o>f.width?"left":i=="left"&&u.left-o<f.left?"right":i;r.removeClass(w).addClass(i)}p=this.getCalculatedOffset(i,u,o,s);this.applyPlacement(p,i);h=function(){e.$element.trigger("shown.bs."+e.type);e.hoverState=null};n.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",h).emulateTransitionEnd(t.TRANSITION_DURATION):h()}};t.prototype.applyPlacement=function(t,i){var r=this.tip(),l=r[0].offsetWidth,e=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),s=parseInt(r.css("margin-left"),10),h,f,u;isNaN(o)&&(o=0);isNaN(s)&&(s=0);t.top=t.top+o;t.left=t.left+s;n.offset.setOffset(r[0],n.extend({using:function(n){r.css({top:Math.round(n.top),left:Math.round(n.left)})}},t),0);r.addClass("in");h=r[0].offsetWidth;f=r[0].offsetHeight;i=="top"&&f!=e&&(t.top=t.top+e-f);u=this.getViewportAdjustedDelta(i,t,h,f);u.left?t.left+=u.left:t.top+=u.top;var c=/top|bottom/.test(i),a=c?u.left*2-l+h:u.top*2-e+f,v=c?"offsetWidth":"offsetHeight";r.offset(t);this.replaceArrow(a,r[0][v],c)};t.prototype.replaceArrow=function(n,t,i){this.arrow().css(i?"left":"top",50*(1-n/t)+"%").css(i?"top":"left","")};t.prototype.setContent=function(){var n=this.tip(),t=this.getTitle();n.find(".tooltip-inner")[this.options.html?"html":"text"](t);n.removeClass("fade in top bottom left right")};t.prototype.hide=function(i){function e(){r.hoverState!="in"&&u.detach();r.$element.removeAttr("aria-describedby").trigger("hidden.bs."+r.type);i&&i()}var r=this,u=this.tip(),f=n.Event("hide.bs."+this.type);if(this.$element.trigger(f),!f.isDefaultPrevented())return u.removeClass("in"),n.support.transition&&this.$tip.hasClass("fade")?u.one("bsTransitionEnd",e).emulateTransitionEnd(t.TRANSITION_DURATION):e(),this.hoverState=null,this};t.prototype.fixTitle=function(){var n=this.$element;(n.attr("title")||typeof n.attr("data-original-title")!="string")&&n.attr("data-original-title",n.attr("title")||"").attr("title","")};t.prototype.hasContent=function(){return this.getTitle()};t.prototype.getPosition=function(t){t=t||this.$element;var u=t[0],r=u.tagName=="BODY",f=window.SVGElement&&u instanceof window.SVGElement,i=u.getBoundingClientRect();i.width==null&&(i=n.extend({},i,{width:i.right-i.left,height:i.bottom-i.top}));var e=r?{top:0,left:0}:t.offset(),o={scroll:r?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},s=f?{}:{width:r?n(window).width():t.outerWidth(),height:r?n(window).height():t.outerHeight()};return n.extend({},i,o,s,e)};t.prototype.getCalculatedOffset=function(n,t,i,r){return n=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-i/2}:n=="top"?{top:t.top-r,left:t.left+t.width/2-i/2}:n=="left"?{top:t.top+t.height/2-r/2,left:t.left-i}:{top:t.top+t.height/2-r/2,left:t.left+t.width}};t.prototype.getViewportAdjustedDelta=function(n,t,i,r){var f={top:0,left:0},e,u,o,s,h,c;return this.$viewport?(e=this.options.viewport&&this.options.viewport.padding||0,u=this.getPosition(this.$viewport),/right|left/.test(n)?(o=t.top-e-u.scroll,s=t.top+e-u.scroll+r,o<u.top?f.top=u.top-o:s>u.top+u.height&&(f.top=u.top+u.height-s)):(h=t.left-e,c=t.left+e+i,h<u.left?f.left=u.left-h:c>u.width&&(f.left=u.left+u.width-c)),f):f};t.prototype.getTitle=function(){var t=this.$element,n=this.options;return t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title)};t.prototype.getUID=function(n){do n+=~~(Math.random()*1e6);while(document.getElementById(n));return n};t.prototype.tip=function(){return this.$tip=this.$tip||n(this.options.template)};t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")};t.prototype.enable=function(){this.enabled=!0};t.prototype.disable=function(){this.enabled=!1};t.prototype.toggleEnabled=function(){this.enabled=!this.enabled};t.prototype.toggle=function(t){var i=this;t&&(i=n(t.currentTarget).data("bs."+this.type),i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)));i.tip().hasClass("in")?i.leave(i):i.enter(i)};t.prototype.destroy=function(){var n=this;clearTimeout(this.timeout);this.hide(function(){n.$element.off("."+n.type).removeData("bs."+n.type)})};i=n.fn.tooltip;n.fn.tooltip=r;n.fn.tooltip.Constructor=t;n.fn.tooltip.noConflict=function(){return n.fn.tooltip=i,this}}(jQuery);+function(n){"use strict";function i(i,r){return this.each(function(){var f=n(this),u=f.data("bs.modal"),e=n.extend({},t.DEFAULTS,f.data(),typeof i=="object"&&i);u||f.data("bs.modal",u=new t(this,e));typeof i=="string"?u[i](r):e.show&&u.show(r)})}var t=function(t,i){this.options=i;this.$body=n(document.body);this.$element=n(t);this.$backdrop=this.isShown=null;this.scrollbarWidth=0;this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,n.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))},r;t.VERSION="3.2.0";t.TRANSITION_DURATION=300;t.BACKDROP_TRANSITION_DURATION=150;t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0};t.prototype.toggle=function(n){return this.isShown?this.hide():this.show(n)};t.prototype.show=function(i){var r=this,u=n.Event("show.bs.modal",{relatedTarget:i});if(this.$element.trigger(u),!this.isShown&&!u.isDefaultPrevented()){this.isShown=!0;this.checkScrollbar();this.$body.addClass("modal-open");this.setScrollbar();this.escape();this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',n.proxy(this.hide,this));this.backdrop(function(){var f=n.support.transition&&r.$element.hasClass("fade"),u;r.$element.parent().length||r.$element.appendTo(r.$body);r.$element.show().scrollTop(0);f&&r.$element[0].offsetWidth;r.$element.addClass("in").attr("aria-hidden",!1);r.enforceFocus();u=n.Event("shown.bs.modal",{relatedTarget:i});f?r.$element.find(".modal-dialog").one("bsTransitionEnd",function(){r.$element.trigger("focus").trigger(u)}).emulateTransitionEnd(t.TRANSITION_DURATION):r.$element.trigger("focus").trigger(u)})}};t.prototype.hide=function(i){(i&&i.preventDefault(),i=n.Event("hide.bs.modal"),this.$element.trigger(i),this.isShown&&!i.isDefaultPrevented())&&(this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),n(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),n.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",n.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal())};t.prototype.enforceFocus=function(){n(document).off("focusin.bs.modal").on("focusin.bs.modal",n.proxy(function(n){this.$element[0]===n.target||this.$element.has(n.target).length||this.$element.trigger("focus")},this))};t.prototype.escape=function(){if(this.isShown&&this.options.keyboard)this.$element.on("keydown.dismiss.bs.modal",n.proxy(function(n){n.which==27&&this.hide()},this));else this.isShown||this.$element.off("keydown.dismiss.bs.modal")};t.prototype.hideModal=function(){var n=this;this.$element.hide();this.backdrop(function(){n.$element.trigger("hidden.bs.modal")})};t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove();this.$backdrop=null};t.prototype.backdrop=function(i){var e=this,f=this.$element.hasClass("fade")?"fade":"",r,u;if(this.isShown&&this.options.backdrop){r=n.support.transition&&f;this.$backdrop=n('<div class="modal-backdrop '+f+'" />').appendTo(this.$body);this.$element.on("click.dismiss.bs.modal",n.proxy(function(n){n.target===n.currentTarget&&(this.options.backdrop=="static"?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this));if(r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!i)return;r?this.$backdrop.one("bsTransitionEnd",i).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):i()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),u=function(){e.removeBackdrop();i&&i()},n.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",u).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):u()):i&&i()};t.prototype.checkScrollbar=function(){this.scrollbarWidth=this.measureScrollbar()};t.prototype.setScrollbar=function(){var n=parseInt(this.$body.css("padding-right")||0,10);this.scrollbarWidth&&this.$body.css("padding-right",n+this.scrollbarWidth)};t.prototype.resetScrollbar=function(){this.$body.css("padding-right","")};t.prototype.measureScrollbar=function(){var n,t;return document.body.clientWidth>=window.innerWidth?0:(n=document.createElement("div"),n.className="modal-scrollbar-measure",this.$body.append(n),t=n.offsetWidth-n.clientWidth,this.$body[0].removeChild(n),t)};r=n.fn.modal;n.fn.modal=i;n.fn.modal.Constructor=t;n.fn.modal.noConflict=function(){return n.fn.modal=r,this};n(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var r=n(this),f=r.attr("href"),u=n(r.attr("data-target")||f&&f.replace(/.*(?=#[^\s]+$)/,"")),e=u.data("bs.modal")?"toggle":n.extend({remote:!/#/.test(f)&&f},u.data(),r.data());r.is("a")&&t.preventDefault();u.one("show.bs.modal",function(n){if(!n.isDefaultPrevented())u.one("hidden.bs.modal",function(){r.is(":visible")&&r.trigger("focus")})});i.call(u,e,this)})}(jQuery),function(n,t){"use strict";typeof define=="function"&&define.amd?define(["jquery"],t):typeof exports=="object"?module.exports=t(require("jquery")):n.bootbox=t(n.jQuery)}(this,function init(n,t){"use strict";function a(n){var t=o[f.locale];return t?t[n]:o.en[n]}function e(t,i,r){t.stopPropagation();t.preventDefault();var u=n.isFunction(r)&&r(t)===!1;u||i.modal("hide")}function v(n){var i,t=0;for(i in n)t++;return t}function r(t,i){var r=0;n.each(t,function(n,t){i(n,t,r++)})}function y(t){var i,u;if(typeof t!="object")throw new Error("Please supply an object of options");if(!t.message)throw new Error("Please specify a message");return t=n.extend({},f,t),t.buttons||(t.buttons={}),t.backdrop=t.backdrop?"static":!1,i=t.buttons,u=v(i),r(i,function(t,r,f){if(n.isFunction(r)&&(r=i[t]={callback:r}),n.type(r)!=="object")throw new Error("button with key "+t+" must be an object");r.label||(r.label=t);r.className||(r.className=u<=2&&f===u-1?"btn-primary":"btn-default")}),t}function p(n,t){var r=n.length,i={};if(r<1||r>2)throw new Error("Invalid argument length");return r===2||typeof n[0]=="string"?(i[t[0]]=n[0],i[t[1]]=n[1]):i=n[0],i}function s(t,i,r){return n.extend(!0,{},t,p(i,r))}function h(n,t,i,r){var u={className:"bootbox-"+n,buttons:c.apply(null,t)};return l(s(u,r,i),t)}function c(){for(var t={},n=0,r=arguments.length;n<r;n++){var i=arguments[n],u=i.toLowerCase(),f=i.toUpperCase();t[u]={label:a(f)}}return t}function l(n,i){var u={};return r(i,function(n,t){u[t]=!0}),r(n.buttons,function(n){if(u[n]===t)throw new Error("button key "+n+" is not allowed (options are "+i.join("\n")+")");}),n}var u={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'><\/div><\/div><\/div><\/div><\/div>",header:"<div class='modal-header'><h4 class='modal-title'><\/h4><\/div>",footer:"<div class='modal-footer'><\/div>",closeButton:"<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;<\/button>",form:"<form class='bootbox-form'><\/form>",inputs:{text:"<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />",textarea:"<textarea class='bootbox-input bootbox-input-textarea form-control'><\/textarea>",email:"<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />",select:"<select class='bootbox-input bootbox-input-select form-control'><\/select>",checkbox:"<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /><\/label><\/div>",date:"<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />",time:"<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />",number:"<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />",password:"<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />"}},f={locale:"en",backdrop:!0,animate:!0,className:null,closeButton:!0,show:!0,container:"body"},i={},o;return i.alert=function(){var t;if(t=h("alert",["ok"],["message","callback"],arguments),t.callback&&!n.isFunction(t.callback))throw new Error("alert requires callback property to be a function when provided");return t.buttons.ok.callback=t.onEscape=function(){return n.isFunction(t.callback)?t.callback():!0},i.dialog(t)},i.confirm=function(){var t;if(t=h("confirm",["cancel","confirm"],["message","callback"],arguments),t.buttons.cancel.callback=t.onEscape=function(){return t.callback(!1)},t.buttons.confirm.callback=function(){return t.callback(!0)},!n.isFunction(t.callback))throw new Error("confirm requires a callback");return i.dialog(t)},i.prompt=function(){var f,p,h,v,e,w,o,b,y,a,k;if(v=n(u.form),p={className:"bootbox-prompt",buttons:c("cancel","confirm"),value:"",inputType:"text"},f=l(s(p,arguments,["title","callback"]),["cancel","confirm"]),w=f.show===t?!0:f.show,b=["date","time","number"],y=document.createElement("input"),y.setAttribute("type",f.inputType),b[f.inputType]&&(f.inputType=y.type),f.message=v,f.buttons.cancel.callback=f.onEscape=function(){return f.callback(null)},f.buttons.confirm.callback=function(){var t,i;switch(f.inputType){case"text":case"textarea":case"email":case"select":case"date":case"time":case"number":case"password":t=e.val();break;case"checkbox":i=e.find("input:checked");t=[];r(i,function(i,r){t.push(n(r).val())})}return f.callback(t)},f.show=!1,!f.title)throw new Error("prompt requires a title");if(!n.isFunction(f.callback))throw new Error("prompt requires a callback");if(!u.inputs[f.inputType])throw new Error("invalid prompt type");e=n(u.inputs[f.inputType]);switch(f.inputType){case"text":case"textarea":case"email":case"date":case"time":case"number":case"password":e.val(f.value);break;case"select":if(a={},o=f.inputOptions||[],!o.length)throw new Error("prompt with select requires options");r(o,function(i,r){var u=e;if(r.value===t||r.text===t)throw new Error("given options in wrong format");r.group&&(a[r.group]||(a[r.group]=n("<optgroup/>").attr("label",r.group)),u=a[r.group]);u.append("<option value='"+r.value+"'>"+r.text+"<\/option>")});r(a,function(n,t){e.append(t)});e.val(f.value);break;case"checkbox":if(k=n.isArray(f.value)?f.value:[f.value],o=f.inputOptions||[],!o.length)throw new Error("prompt with checkbox requires options");if(!o[0].value||!o[0].text)throw new Error("given options in wrong format");e=n("<div/>");r(o,function(t,i){var o=n(u.inputs[f.inputType]);o.find("input").attr("value",i.value);o.find("label").append(i.text);r(k,function(n,t){t===i.value&&o.find("input").prop("checked",!0)});e.append(o)})}f.placeholder&&e.attr("placeholder",f.placeholder);f.pattern&&e.attr("pattern",f.pattern);v.append(e);v.on("submit",function(n){n.preventDefault();h.find(".btn-primary").click()});h=i.dialog(f);h.off("shown.bs.modal");h.on("shown.bs.modal",function(){e.focus()});return w===!0&&h.modal("show"),h},i.dialog=function(t){var h;t=y(t);var i=n(u.dialog),o=i.find(".modal-body"),c=t.buttons,s="",f={onEscape:t.onEscape};r(c,function(n,t){s+="<button data-bb-handler='"+n+"' type='button' class='btn "+t.className+"'>"+t.label+"<\/button>";f[n]=t.callback});o.find(".bootbox-body").html(t.message);t.animate===!0&&i.addClass("fade");t.className&&i.addClass(t.className);t.title&&o.before(u.header);t.closeButton&&(h=n(u.closeButton),t.title?i.find(".modal-header").prepend(h):h.css("margin-top","-10px").prependTo(o));t.title&&i.find(".modal-title").html(t.title);s.length&&(o.after(u.footer),i.find(".modal-footer").html(s));i.on("hidden.bs.modal",function(n){n.target===this&&i.remove()});i.on("shown.bs.modal",function(){i.find(".btn-primary:first").focus()});i.on("escape.close.bb",function(n){f.onEscape&&e(n,i,f.onEscape)});i.on("click",".modal-footer button",function(t){var r=n(this).data("bb-handler");e(t,i,f[r])});i.on("click",".bootbox-close-button",function(n){e(n,i,f.onEscape)});i.on("keyup",function(n){n.which===27&&i.trigger("escape.close.bb")});return n(t.container).append(i),i.modal({backdrop:t.backdrop,keyboard:!1,show:!1}),t.show&&i.modal("show"),i},i.setDefaults=function(){var t={};arguments.length===2?t[arguments[0]]=arguments[1]:t=arguments[0];n.extend(f,t)},i.hideAll=function(){n(".bootbox").modal("hide")},o={br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},he:{OK:"אישור",CANCEL:"ביטול",CONFIRM:"אישור"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},lt:{OK:"Gerai",CANCEL:"Atšaukti",CONFIRM:"Patvirtinti"},lv:{OK:"Labi",CANCEL:"Atcelt",CONFIRM:"Apstiprināt"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"Potwierdź"},ru:{OK:"OK",CANCEL:"Отмена",CONFIRM:"Применить"},sv:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},tr:{OK:"Tamam",CANCEL:"İptal",CONFIRM:"Onayla"},zh_CN:{OK:"OK",CANCEL:"取消",CONFIRM:"确认"},zh_TW:{OK:"OK",CANCEL:"取消",CONFIRM:"確認"}},i.init=function(t){return init(t||n)},i}),function(){"use strict";MbWaitSpinner=function(n){if(!$().spin)throw new Error("Spin.js required !!!");var t={};$.extend(t,{locked:!1,overlayColor:"transparent",color:"#000",callback:null},n);this.locked=t.locked;this.overlayColor=t.windowColor;this.spinOptions=t;this.callback=t.callback};MbWaitSpinner.prototype={show:function(){this.$element=$("<div />");this.locked?this.$element.css({position:"fixed",top:0,bottom:0,left:0,right:0,"background-color":this.overlayColor,"z-index":1e3}):this.$element.css({position:"fixed",top:"50%",left:"50%",height:"80px",width:"80px",margin:"-40px 0 0 -40px"});this.$element.appendTo("body").spin(this.spinOptions)},hide:function(){this.$element.remove()}};$.fn.mb_waitspinner=function(n){return $(this).each(function(t){var i;t==0&&(i=new MbWaitSpinner(n),i.show(),$(window).load(function(){$.isFunction(i.callback)?i.callback(i)&&i.hide():i.hide()}))})}}.call(this);
/*
//# sourceMappingURL=FileManager.min.js.map
*/